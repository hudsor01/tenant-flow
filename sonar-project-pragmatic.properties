# Pragmatic SonarQube Configuration for TenantFlow
# This configuration focuses on new code quality and gradual improvement

# Project identification
sonar.projectKey=tenantflow
sonar.organization=tenantflow
sonar.projectName=TenantFlow Property Management Platform
sonar.projectVersion=1.0.0

# New Code Period - Only analyze code changed in last 30 days
sonar.newCode.referenceBranch=main
sonar.projectDate=2024-12-01

# Source code configuration
sonar.sources=apps/frontend/src,apps/backend/src,packages/shared/src
sonar.exclusions=**/*.test.ts,**/*.test.tsx,**/*.spec.ts,**/node_modules/**,**/dist/**,**/build/**,**/.next/**,**/coverage/**,**/*.config.js,**/*.config.ts,**/generated/**,**/migrations/**,**/__mocks__/**,**/test-utils/**

# Additional exclusions for existing code patterns
sonar.exclusions=sonar.exclusions,**/legacy/**,**/deprecated/**,**/*.stories.tsx,**/*.cy.ts

# Test configuration
sonar.tests=apps/frontend/src,apps/backend/src,packages/shared/src
sonar.test.inclusions=**/*.test.ts,**/*.test.tsx,**/*.spec.ts
sonar.javascript.lcov.reportPaths=coverage/lcov.info
sonar.coverage.exclusions=**/*.test.ts,**/*.test.tsx,**/*.spec.ts,**/*.config.ts,**/*.config.js,**/test/**,**/tests/**,**/mocks/**,**/*.d.ts

# TypeScript configuration
sonar.typescript.tsconfigPath=tsconfig.json

# Language-specific settings
sonar.javascript.node.maxspace=8192

# Quality gates - Focus on new code
sonar.qualitygate.wait=true

# Issue exclusions for existing patterns
sonar.issue.ignore.multicriteria=e1,e2,e3,e4,e5,e6,e7,e8,e9,e10

# e1: Allow void operator for promise handling (common in React)
sonar.issue.ignore.multicriteria.e1.ruleKey=typescript:S3735
sonar.issue.ignore.multicriteria.e1.resourceKey=**/*.ts,**/*.tsx

# e2: Allow TODO comments (tracked separately)
sonar.issue.ignore.multicriteria.e2.ruleKey=typescript:S1135
sonar.issue.ignore.multicriteria.e2.resourceKey=**/*.ts,**/*.tsx

# e3: Allow console in development files
sonar.issue.ignore.multicriteria.e3.ruleKey=typescript:S106
sonar.issue.ignore.multicriteria.e3.resourceKey=**/dev.ts,**/scripts/**,**/*.dev.ts

# e4: Cognitive complexity relaxed for React components
sonar.issue.ignore.multicriteria.e4.ruleKey=typescript:S3776
sonar.issue.ignore.multicriteria.e4.resourceKey=**/components/**/*.tsx,**/pages/**/*.tsx

# e5: Allow any type in specific files (migrations, configs)
sonar.issue.ignore.multicriteria.e5.ruleKey=typescript:S4325
sonar.issue.ignore.multicriteria.e5.resourceKey=**/migrations/**,**/*.config.ts

# e6: Ignore duplicate strings in test files
sonar.issue.ignore.multicriteria.e6.ruleKey=typescript:S1192
sonar.issue.ignore.multicriteria.e6.resourceKey=**/*.test.ts,**/*.test.tsx,**/*.spec.ts

# e7: Allow type assertions in shared types
sonar.issue.ignore.multicriteria.e7.ruleKey=typescript:S4325
sonar.issue.ignore.multicriteria.e7.resourceKey=**/shared/src/types/**

# e8: Ignore function length in route handlers
sonar.issue.ignore.multicriteria.e8.ruleKey=typescript:S138
sonar.issue.ignore.multicriteria.e8.resourceKey=**/routes/**,**/api/**

# e9: Allow nested ternaries in JSX (common React pattern)
sonar.issue.ignore.multicriteria.e9.ruleKey=typescript:S3358
sonar.issue.ignore.multicriteria.e9.resourceKey=**/*.tsx

# e10: Ignore commented code in development
sonar.issue.ignore.multicriteria.e10.ruleKey=typescript:S125
sonar.issue.ignore.multicriteria.e10.resourceKey=**/*.dev.ts,**/examples/**

# Duplication detection thresholds (more lenient)
sonar.cpd.exclusions=**/*.test.ts,**/*.test.tsx,**/*.spec.ts,**/generated/**
sonar.duplications.exclusions=**/test/**,**/tests/**

# Coverage requirements (gradual improvement)
sonar.coverage.exclusions=**/test/**,**/*.test.ts,**/*.test.tsx,**/*.spec.ts,**/index.ts,**/types.ts