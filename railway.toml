[build]
builder = "DOCKERFILE"
dockerfilePath = "./Dockerfile"

[deploy]
# Fixed path - NestJS builds to dist/main.js from the backend directory
startCommand = "node apps/backend/dist/apps/backend/src/main.js"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10
healthcheckPath = "/health"
healthcheckTimeout = 30

[variables]
NODE_ENV = "production"
PORT = "${{ PORT }}"
