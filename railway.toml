[build]
builder = "DOCKERFILE"
dockerfilePath = "./Dockerfile"
watchPatterns = [
  "apps/backend/**",
  "packages/shared/**",
  "packages/**",
  "package.json",
  "pnpm-lock.yaml",
  "pnpm-workspace.yaml",
  "turbo.json",
  "Dockerfile",
  ".dockerignore"
]

[deploy]
# Use /health/ping for liveness check (no DB dependency, fast startup)
# Full health check at /health/ready verifies DB connectivity
healthcheckPath = "/health/ping"
healthcheckTimeout = 120
overlapSeconds = 10
drainingSeconds = 30
restartPolicyType = "ALWAYS"
restartPolicyMaxRetries = 5

# NOTE: Database migrations are managed via Supabase CLI, not pnpm
# Run `pnpm db:push` locally or via CI before deploying code changes
