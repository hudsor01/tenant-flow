{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/apps/frontend/src/lib/logger.ts"],"sourcesContent":["/**\n * Logger utility for frontend\n * Simple console wrapper with levels\n */\n\nexport interface Logger {\n  debug(message: string, ...args: unknown[]): void;\n  info(message: string, ...args: unknown[]): void;\n  warn(message: string, ...args: unknown[]): void;\n  error(message: string, ...args: unknown[]): void;\n}\n\nexport const logger: Logger = {\n  debug: (message: string, ...args: unknown[]) => {\n    if (process.env.NODE_ENV === 'development') {\n      console.debug(`[DEBUG] ${message}`, ...args);\n    }\n  },\n  \n  info: (message: string, ...args: unknown[]) => {\n    console.info(`[INFO] ${message}`, ...args);\n  },\n  \n  warn: (message: string, ...args: unknown[]) => {\n    console.warn(`[WARN] ${message}`, ...args);\n  },\n  \n  error: (message: string, ...args: unknown[]) => {\n    console.error(`[ERROR] ${message}`, ...args);\n  },\n};"],"names":[],"mappings":"AAAA;;;CAGC;;;AASM,MAAM,SAAiB;IAC5B,OAAO,CAAC,SAAiB,GAAG;QAC1B,wCAA4C;YAC1C,QAAQ,KAAK,CAAC,CAAC,QAAQ,EAAE,SAAS,KAAK;QACzC;IACF;IAEA,MAAM,CAAC,SAAiB,GAAG;QACzB,QAAQ,IAAI,CAAC,CAAC,OAAO,EAAE,SAAS,KAAK;IACvC;IAEA,MAAM,CAAC,SAAiB,GAAG;QACzB,QAAQ,IAAI,CAAC,CAAC,OAAO,EAAE,SAAS,KAAK;IACvC;IAEA,OAAO,CAAC,SAAiB,GAAG;QAC1B,QAAQ,KAAK,CAAC,CAAC,QAAQ,EAAE,SAAS,KAAK;IACzC;AACF"}},
    {"offset": {"line": 47, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/apps/frontend/src/lib/security/enhanced-security-headers.ts"],"sourcesContent":["/**\n * Enhanced Security Headers with Nonce-Based CSP\n * Production-grade security with comprehensive protection\n * \n * CRITICAL FIXES FOR NEXT.JS 15 PRODUCTION:\n * - unsafe-eval REQUIRED for Next.js dynamic imports and webpack chunks\n * - unsafe-inline REQUIRED for Next.js initialization scripts\n * - Dynamic domain detection based on NEXT_PUBLIC_APP_URL\n * - Middleware excludes _next/ routes to prevent CSP conflicts\n * \n * CSP Configuration supports:\n * ✅ Next.js production chunks and dynamic imports\n * ✅ Stripe payment processing\n * ✅ Google Maps integration\n * ✅ PostHog analytics\n * ✅ Supabase authentication\n * ✅ Font loading from Google Fonts\n */\n\nimport type { NextRequest, NextResponse } from 'next/server';\nimport { logger } from '../logger';\n\n// Nonce storage for CSP\nconst nonceStore = new Map<string, { nonce: string; expires: number }>();\n\n/**\n * Generate cryptographically secure nonce for CSP\n */\nexport function generateCSPNonce(): string {\n  const array = new Uint8Array(16);\n  crypto.getRandomValues(array);\n  return Array.from(array, byte => byte.toString(16).padStart(2, '0')).join('');\n}\n\n/**\n * Get or create nonce for current request\n */\nexport function getOrCreateNonce(sessionId?: string): string {\n  const key = sessionId || 'global';\n  const stored = nonceStore.get(key);\n  \n  if (stored && stored.expires > Date.now()) {\n    return stored.nonce;\n  }\n  \n  const nonce = generateCSPNonce();\n  nonceStore.set(key, {\n    nonce,\n    expires: Date.now() + (60 * 60 * 1000), // 1 hour\n  });\n  \n  return nonce;\n}\n\n/**\n * Enhanced Security Configuration\n */\nconst ENHANCED_SECURITY_CONFIG = {\n  // Content Security Policy with nonce support\n  CSP: {\n    'default-src': [\"'self'\"],\n    'script-src': [], // Will be populated dynamically based on environment\n    'style-src': [\n      \"'self'\",\n      \"'unsafe-inline'\", // Required for Next.js inline styles\n      'https://fonts.googleapis.com',\n      'https://cdn.jsdelivr.net', // For external CSS frameworks if needed\n    ],\n    'img-src': [\n      \"'self'\",\n      'data:',\n      'blob:',\n      'https:',\n      '*.supabase.co',\n      '*.googleusercontent.com',\n      'https://maps.googleapis.com',\n      'https://maps.gstatic.com',\n      'https://images.unsplash.com',\n    ],\n    'font-src': [\n      \"'self'\",\n      'data:',\n      'https://fonts.gstatic.com',\n      'https://cdn.jsdelivr.net',\n    ],\n    'connect-src': [\n      \"'self'\",\n      'https://api.tenantflow.app',\n      'https://*.supabase.co',\n      'https://js.stripe.com',\n      'https://api.stripe.com',\n      'https://us.i.posthog.com', // PostHog analytics endpoints\n      'wss:',\n    ],\n    'frame-src': [\n      \"'self'\",\n      'https://js.stripe.com',\n      'https://hooks.stripe.com',\n    ],\n    'object-src': [\"'none'\"],\n    'base-uri': [\"'self'\"],\n    'form-action': [\"'self'\"],\n    'frame-ancestors': [\"'none'\"],\n    'upgrade-insecure-requests': [],\n    'block-all-mixed-content': [],\n  },\n\n  // Enhanced Permissions Policy\n  PERMISSIONS_POLICY: {\n    camera: '()',\n    microphone: '()',\n    geolocation: '(self)',\n    gyroscope: '()',\n    magnetometer: '()',\n    payment: '(self \"https://js.stripe.com\")',\n    usb: '()',\n    'interest-cohort': '()',\n    'browsing-topics': '()', // Topics API\n    'attribution-reporting': '()', // Attribution Reporting API\n    'trust-token-redemption': '()', // Trust Token API\n    fullscreen: '(self)',\n    'picture-in-picture': '(self)',\n    'accelerometer': '()',\n    'ambient-light-sensor': '()',\n    'autoplay': '(self)',\n    'clipboard-read': '()',\n    'clipboard-write': '(self)',\n    'display-capture': '()',\n    'document-domain': '()',\n    'encrypted-media': '()',\n    'execution-while-not-rendered': '()',\n    'execution-while-out-of-viewport': '()',\n    'gamepad': '()',\n    'hid': '()',\n    'idle-detection': '()',\n    'local-fonts': '()',\n    'midi': '()',\n    'navigation-override': '()',\n    'otp-credentials': '()',\n    'publickey-credentials-create': '(self)',\n    'publickey-credentials-get': '(self)',\n    'screen-wake-lock': '()',\n    'serial': '()',\n    'speaker-selection': '()',\n    'storage-access': '()',\n    'web-share': '(self)',\n    'window-management': '()',\n    'xr-spatial-tracking': '()',\n  },\n\n  // Strict Transport Security\n  HSTS: {\n    maxAge: 63072000, // 2 years\n    includeSubDomains: true,\n    preload: true,\n  },\n\n  // Cross-Origin policies\n  CROSS_ORIGIN: {\n    embedderPolicy: 'require-corp',\n    openerPolicy: 'same-origin',\n    resourcePolicy: 'cross-origin',\n  },\n};\n\n/**\n * Get allowed domains based on environment\n */\nfunction getAllowedDomains(): string[] {\n  const baseUrl = process.env.NEXT_PUBLIC_APP_URL || 'http://localhost:3000';\n  const domains = [\"'self'\"];\n  \n  // Add current domain\n  if (baseUrl.includes('tenantflow.app')) {\n    domains.push('https://tenantflow.app');\n  } else if (baseUrl.includes('vercel.app')) {\n    domains.push('*.vercel.app');\n    domains.push('*.vercel-deployments.com');\n  } else if (baseUrl.includes('localhost')) {\n    domains.push('http://localhost:3000');\n    domains.push('http://localhost:3004'); \n    domains.push('ws://localhost:*');\n  }\n  \n  return domains;\n}\n\n/**\n * Build CSP header with nonce replacement\n */\nfunction buildEnhancedCSPHeader(isDevelopment: boolean, nonce: string): string {\n  const csp = { ...ENHANCED_SECURITY_CONFIG.CSP };\n  \n  // Get dynamic domains based on environment\n  const allowedDomains = getAllowedDomains();\n  \n  // Update script-src with dynamic domains and Next.js chunk support\n  csp['script-src'] = [\n    \"'self'\",\n    \"'unsafe-inline'\", // Required for Next.js inline scripts and initialization\n    \"'unsafe-eval'\", // Required for Next.js dynamic imports and webpack chunks\n    ...allowedDomains.filter(domain => domain !== \"'self'\"),\n    // External services\n    'https://js.stripe.com',\n    'https://maps.googleapis.com', \n    'https://us.i.posthog.com', // PostHog analytics\n  ];\n  \n  // Replace nonce placeholder in remaining directives\n  csp['style-src'] = csp['style-src'].map(src => \n    src.replace('{{NONCE}}', nonce)\n  );\n  \n  if (isDevelopment) {\n    // Development-specific CSP adjustments for Next.js\n    csp['connect-src'] = [\n      ...csp['connect-src'],\n      'ws://localhost:*',\n      'ws://127.0.0.1:*',\n      'http://localhost:*',\n      'http://127.0.0.1:*',\n      // Next.js dev server\n      'http://localhost:3000',\n      'http://localhost:3004',\n    ];\n    \n    // Allow unsafe-eval for development builds (Next.js requires this)\n    csp['script-src'] = [...csp['script-src'], \"'unsafe-eval'\", \"'unsafe-inline'\"];\n    \n    // Allow unsafe-inline for development styles (Next.js dev mode)\n    csp['style-src'] = [...csp['style-src'], \"'unsafe-inline'\"];\n    \n    // More permissive object-src for development\n    csp['object-src'] = [\"'none'\"];\n    \n    // Allow data URLs for fonts in development\n    csp['font-src'] = [...csp['font-src'], \"'unsafe-inline'\"];\n  } else {\n    // Production: Keep both unsafe-inline AND unsafe-eval for Next.js compatibility\n    // Next.js requires these for proper functionality even in production:\n    // - unsafe-inline: For inline scripts and initialization\n    // - unsafe-eval: For dynamic imports and code splitting chunks\n    // The framework adds its own security measures for safe evaluation\n    \n    // Do NOT remove unsafe-eval in production - Next.js needs it for chunks\n    // csp['script-src'] = csp['script-src'] (keep as-is)\n    \n    // Keep unsafe-inline for styles as Next.js requires it\n  }\n  \n  // Build CSP string\n  return Object.entries(csp)\n    .map(([directive, sources]) => {\n      if (sources.length === 0) {\n        return directive;\n      }\n      return `${directive} ${sources.join(' ')}`;\n    })\n    .join('; ');\n}\n\n/**\n * Build enhanced Permissions Policy header\n */\nfunction buildEnhancedPermissionsPolicyHeader(): string {\n  return Object.entries(ENHANCED_SECURITY_CONFIG.PERMISSIONS_POLICY)\n    .map(([feature, policy]) => `${feature}=${policy}`)\n    .join(', ');\n}\n\n/**\n * Apply comprehensive enhanced security headers\n */\nexport function applyEnhancedSecurityHeaders(\n  response: NextResponse,\n  request: NextRequest,\n  sessionId?: string\n): NextResponse {\n  const isProduction = process.env.NODE_ENV === 'production';\n  const isDevelopment = process.env.NODE_ENV === 'development';\n  \n  // Generate nonce for this request\n  const nonce = getOrCreateNonce(sessionId);\n  \n  // Content Security Policy with nonce\n  const cspHeader = buildEnhancedCSPHeader(isDevelopment, nonce);\n  \n  // Apply CSP in production or when explicitly enabled in development\n  // CRITICAL: Always apply CSP in production to prevent JS blocking issues\n  if (isProduction || process.env.ENABLE_DEV_CSP === 'true') {\n    response.headers.set('Content-Security-Policy', cspHeader);\n    \n    // Log CSP header in development for debugging\n    if (isDevelopment && process.env.ENABLE_DEV_CSP === 'true') {\n      logger.info('[CSP DEBUG]', { cspHeader, nonce });\n    }\n  }\n  \n  // Store nonce in response header for client access\n  response.headers.set('X-CSP-Nonce', nonce);\n  \n  // Report-Only CSP for testing new policies (removed - causes warnings without report-to)\n  // Note: Report-only mode requires 'report-to' directive which needs endpoint setup\n  // if (isDevelopment) {\n  //   response.headers.set('Content-Security-Policy-Report-Only', cspHeader);\n  // }\n  \n  // Strict Transport Security (HTTPS only)\n  if (isProduction) {\n    const hstsHeader = `max-age=${ENHANCED_SECURITY_CONFIG.HSTS.maxAge}; includeSubDomains; preload`;\n    response.headers.set('Strict-Transport-Security', hstsHeader);\n  }\n  \n  // Enhanced security headers\n  response.headers.set('X-Frame-Options', 'DENY');\n  response.headers.set('X-Content-Type-Options', 'nosniff');\n  response.headers.set('X-XSS-Protection', '1; mode=block');\n  response.headers.set('Referrer-Policy', 'strict-origin-when-cross-origin');\n  \n  // Enhanced Permissions Policy\n  const permissionsPolicyHeader = buildEnhancedPermissionsPolicyHeader();\n  response.headers.set('Permissions-Policy', permissionsPolicyHeader);\n  \n  // Cross-Origin policies\n  response.headers.set('Cross-Origin-Embedder-Policy', ENHANCED_SECURITY_CONFIG.CROSS_ORIGIN.embedderPolicy);\n  response.headers.set('Cross-Origin-Opener-Policy', ENHANCED_SECURITY_CONFIG.CROSS_ORIGIN.openerPolicy);\n  response.headers.set('Cross-Origin-Resource-Policy', ENHANCED_SECURITY_CONFIG.CROSS_ORIGIN.resourcePolicy);\n  \n  // Additional security headers\n  response.headers.set('X-Download-Options', 'noopen'); // IE security\n  response.headers.set('X-Permitted-Cross-Domain-Policies', 'none'); // Adobe Flash/PDF\n  response.headers.set('X-DNS-Prefetch-Control', 'on');\n  \n  // Certificate Transparency\n  if (isProduction) {\n    response.headers.set('Expect-CT', 'enforce, max-age=86400, report-uri=\"/.well-known/ct-report\"');\n  }\n  \n  // Remove server information\n  response.headers.delete('Server');\n  response.headers.delete('X-Powered-By');\n  \n  // Cache control based on route sensitivity\n  if (isSensitiveRoute(request.nextUrl.pathname)) {\n    response.headers.set('Cache-Control', 'no-store, no-cache, must-revalidate, proxy-revalidate, max-age=0');\n    response.headers.set('Pragma', 'no-cache');\n    response.headers.set('Expires', '0');\n    response.headers.set('Surrogate-Control', 'no-store');\n  } else {\n    response.headers.set('Cache-Control', 'public, max-age=300, s-maxage=300, stale-while-revalidate=60');\n  }\n  \n  // Security debugging in development\n  if (isDevelopment) {\n    response.headers.set('X-Security-Debug', 'enabled');\n    // Removed X-CSP-Report-Only header as we're not using report-only mode\n  }\n  \n  return response;\n}\n\n/**\n * Enhanced sensitive route detection\n */\nfunction isSensitiveRoute(pathname: string): boolean {\n  const sensitivePatterns = [\n    /^\\/auth\\//,\n    /^\\/admin\\//,\n    /^\\/api\\/.*\\/(users|auth|admin)/,\n    /^\\/settings/,\n    /^\\/profile/,\n    /financial|billing|payment/i,\n    /tenant-dashboard/i,\n    /landlord-portal/i,\n    /properties\\/.+/i,\n    /tenants\\/.+/i,\n    /maintenance/i,\n    /leases/i,\n    /api\\/.*\\/(properties|tenants|maintenance|financial|leases)/i,\n    /documents\\/.*\\.(pdf|doc|docx)/i,\n  ];\n  \n  return sensitivePatterns.some(pattern => pattern.test(pathname));\n}\n\n/**\n * Clean up expired nonces\n */\nfunction cleanupExpiredNonces(): void {\n  const now = Date.now();\n  for (const [key, data] of nonceStore.entries()) {\n    if (data.expires < now) {\n      nonceStore.delete(key);\n    }\n  }\n}\n\n// Start cleanup interval\nsetInterval(cleanupExpiredNonces, 10 * 60 * 1000); // Every 10 minutes\n\n/**\n * Get nonce for client-side script injection\n */\nexport function getClientNonce(): string | null {\n  if (typeof window === 'undefined') return null;\n  \n  // Try to get from meta tag first\n  const metaNonce = document.querySelector('meta[name=\"csp-nonce\"]')?.getAttribute('content');\n  if (metaNonce) return metaNonce;\n  \n  // Try to get from response header (would need server-side setup)\n  return null;\n}\n\n/**\n * React hook for CSP nonce management\n * Note: This must be used in client components only\n */\nexport function useCSPNonce(): string | null {\n  if (typeof window === 'undefined') {\n    // useCSPNonce called on server-side. This hook is client-only.\n    return null;\n  }\n  \n  // This will be replaced with proper React hook implementation in client components\n  return getClientNonce();\n}\n\n/**\n * Helper to create nonce-secured script tag\n */\nexport function createSecureScript(src: string, nonce?: string): HTMLScriptElement {\n  const script = document.createElement('script');\n  script.src = src;\n  if (nonce) {\n    script.nonce = nonce;\n  }\n  return script;\n}\n\n/**\n * Helper to create nonce-secured inline script\n */\nexport function createSecureInlineScript(content: string, nonce?: string): HTMLScriptElement {\n  const script = document.createElement('script');\n  script.textContent = content;\n  if (nonce) {\n    script.nonce = nonce;\n  }\n  return script;\n}\n\n/**\n * CSP violation report interface\n */\ninterface CSPViolationReport {\n  blockedURI?: string;\n  documentURI?: string;\n  effectiveDirective?: string;\n  originalPolicy?: string;\n  referrer?: string;\n  violatedDirective?: string;\n  sourceFile?: string;\n  lineNumber?: number;\n  columnNumber?: number;\n  sample?: string;\n}\n\n/**\n * CSP violation report handler for monitoring\n */\nexport function handleCSPViolation(violationReport: CSPViolationReport): void {\n  logger.warn('[CSP VIOLATION]', {\n    blockedURI: violationReport.blockedURI,\n    documentURI: violationReport.documentURI,\n    effectiveDirective: violationReport.effectiveDirective,\n    originalPolicy: violationReport.originalPolicy,\n    referrer: violationReport.referrer,\n    violatedDirective: violationReport.violatedDirective,\n    timestamp: new Date().toISOString(),\n  });\n  \n  // In production, send to monitoring service\n  if (process.env.NODE_ENV === 'production') {\n    // fetch('/api/csp-violations', {\n    //   method: 'POST',\n    //   headers: { 'Content-Type': 'application/json' },\n    //   body: JSON.stringify(violationReport)\n    // }).catch(console.error);\n  }\n}\n\n/**\n * Initialize CSP violation reporting\n */\nexport function initializeCSPReporting(): void {\n  if (typeof window === 'undefined') return;\n  \n  document.addEventListener('securitypolicyviolation', (event) => {\n    handleCSPViolation({\n      blockedURI: event.blockedURI,\n      documentURI: event.documentURI,\n      effectiveDirective: event.effectiveDirective,\n      originalPolicy: event.originalPolicy,\n      referrer: event.referrer,\n      violatedDirective: event.violatedDirective,\n    });\n  });\n}\n"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;CAiBC;;;;;;;;;;;AAGD;;AAEA,wBAAwB;AACxB,MAAM,aAAa,IAAI;AAKhB,SAAS;IACd,MAAM,QAAQ,IAAI,WAAW;IAC7B,OAAO,eAAe,CAAC;IACvB,OAAO,MAAM,IAAI,CAAC,OAAO,CAAA,OAAQ,KAAK,QAAQ,CAAC,IAAI,QAAQ,CAAC,GAAG,MAAM,IAAI,CAAC;AAC5E;AAKO,SAAS,iBAAiB,SAAkB;IACjD,MAAM,MAAM,aAAa;IACzB,MAAM,SAAS,WAAW,GAAG,CAAC;IAE9B,IAAI,UAAU,OAAO,OAAO,GAAG,KAAK,GAAG,IAAI;QACzC,OAAO,OAAO,KAAK;IACrB;IAEA,MAAM,QAAQ;IACd,WAAW,GAAG,CAAC,KAAK;QAClB;QACA,SAAS,KAAK,GAAG,KAAM,KAAK,KAAK;IACnC;IAEA,OAAO;AACT;AAEA;;CAEC,GACD,MAAM,2BAA2B;IAC/B,6CAA6C;IAC7C,KAAK;QACH,eAAe;YAAC;SAAS;QACzB,cAAc,EAAE;QAChB,aAAa;YACX;YACA;YACA;YACA;SACD;QACD,WAAW;YACT;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;SACD;QACD,YAAY;YACV;YACA;YACA;YACA;SACD;QACD,eAAe;YACb;YACA;YACA;YACA;YACA;YACA;YACA;SACD;QACD,aAAa;YACX;YACA;YACA;SACD;QACD,cAAc;YAAC;SAAS;QACxB,YAAY;YAAC;SAAS;QACtB,eAAe;YAAC;SAAS;QACzB,mBAAmB;YAAC;SAAS;QAC7B,6BAA6B,EAAE;QAC/B,2BAA2B,EAAE;IAC/B;IAEA,8BAA8B;IAC9B,oBAAoB;QAClB,QAAQ;QACR,YAAY;QACZ,aAAa;QACb,WAAW;QACX,cAAc;QACd,SAAS;QACT,KAAK;QACL,mBAAmB;QACnB,mBAAmB;QACnB,yBAAyB;QACzB,0BAA0B;QAC1B,YAAY;QACZ,sBAAsB;QACtB,iBAAiB;QACjB,wBAAwB;QACxB,YAAY;QACZ,kBAAkB;QAClB,mBAAmB;QACnB,mBAAmB;QACnB,mBAAmB;QACnB,mBAAmB;QACnB,gCAAgC;QAChC,mCAAmC;QACnC,WAAW;QACX,OAAO;QACP,kBAAkB;QAClB,eAAe;QACf,QAAQ;QACR,uBAAuB;QACvB,mBAAmB;QACnB,gCAAgC;QAChC,6BAA6B;QAC7B,oBAAoB;QACpB,UAAU;QACV,qBAAqB;QACrB,kBAAkB;QAClB,aAAa;QACb,qBAAqB;QACrB,uBAAuB;IACzB;IAEA,4BAA4B;IAC5B,MAAM;QACJ,QAAQ;QACR,mBAAmB;QACnB,SAAS;IACX;IAEA,wBAAwB;IACxB,cAAc;QACZ,gBAAgB;QAChB,cAAc;QACd,gBAAgB;IAClB;AACF;AAEA;;CAEC,GACD,SAAS;IACP,MAAM,UAAU,8DAAmC;IACnD,MAAM,UAAU;QAAC;KAAS;IAE1B,qBAAqB;IACrB,IAAI,QAAQ,QAAQ,CAAC,mBAAmB;QACtC,QAAQ,IAAI,CAAC;IACf,OAAO,IAAI,QAAQ,QAAQ,CAAC,eAAe;QACzC,QAAQ,IAAI,CAAC;QACb,QAAQ,IAAI,CAAC;IACf,OAAO,IAAI,QAAQ,QAAQ,CAAC,cAAc;QACxC,QAAQ,IAAI,CAAC;QACb,QAAQ,IAAI,CAAC;QACb,QAAQ,IAAI,CAAC;IACf;IAEA,OAAO;AACT;AAEA;;CAEC,GACD,SAAS,uBAAuB,aAAsB,EAAE,KAAa;IACnE,MAAM,MAAM;QAAE,GAAG,yBAAyB,GAAG;IAAC;IAE9C,2CAA2C;IAC3C,MAAM,iBAAiB;IAEvB,mEAAmE;IACnE,GAAG,CAAC,aAAa,GAAG;QAClB;QACA;QACA;WACG,eAAe,MAAM,CAAC,CAAA,SAAU,WAAW;QAC9C,oBAAoB;QACpB;QACA;QACA;KACD;IAED,oDAAoD;IACpD,GAAG,CAAC,YAAY,GAAG,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,CAAA,MACtC,IAAI,OAAO,CAAC,aAAa;IAG3B,IAAI,eAAe;QACjB,mDAAmD;QACnD,GAAG,CAAC,cAAc,GAAG;eAChB,GAAG,CAAC,cAAc;YACrB;YACA;YACA;YACA;YACA,qBAAqB;YACrB;YACA;SACD;QAED,mEAAmE;QACnE,GAAG,CAAC,aAAa,GAAG;eAAI,GAAG,CAAC,aAAa;YAAE;YAAiB;SAAkB;QAE9E,gEAAgE;QAChE,GAAG,CAAC,YAAY,GAAG;eAAI,GAAG,CAAC,YAAY;YAAE;SAAkB;QAE3D,6CAA6C;QAC7C,GAAG,CAAC,aAAa,GAAG;YAAC;SAAS;QAE9B,2CAA2C;QAC3C,GAAG,CAAC,WAAW,GAAG;eAAI,GAAG,CAAC,WAAW;YAAE;SAAkB;IAC3D,OAAO;IACL,gFAAgF;IAChF,sEAAsE;IACtE,yDAAyD;IACzD,+DAA+D;IAC/D,mEAAmE;IAEnE,wEAAwE;IACxE,qDAAqD;IAErD,uDAAuD;IACzD;IAEA,mBAAmB;IACnB,OAAO,OAAO,OAAO,CAAC,KACnB,GAAG,CAAC,CAAC,CAAC,WAAW,QAAQ;QACxB,IAAI,QAAQ,MAAM,KAAK,GAAG;YACxB,OAAO;QACT;QACA,OAAO,GAAG,UAAU,CAAC,EAAE,QAAQ,IAAI,CAAC,MAAM;IAC5C,GACC,IAAI,CAAC;AACV;AAEA;;CAEC,GACD,SAAS;IACP,OAAO,OAAO,OAAO,CAAC,yBAAyB,kBAAkB,EAC9D,GAAG,CAAC,CAAC,CAAC,SAAS,OAAO,GAAK,GAAG,QAAQ,CAAC,EAAE,QAAQ,EACjD,IAAI,CAAC;AACV;AAKO,SAAS,6BACd,QAAsB,EACtB,OAAoB,EACpB,SAAkB;IAElB,MAAM,eAAe,oDAAyB;IAC9C,MAAM,gBAAgB,oDAAyB;IAE/C,kCAAkC;IAClC,MAAM,QAAQ,iBAAiB;IAE/B,qCAAqC;IACrC,MAAM,YAAY,uBAAuB,eAAe;IAExD,oEAAoE;IACpE,yEAAyE;IACzE,IAAI,gBAAgB,QAAQ,GAAG,CAAC,cAAc,KAAK,QAAQ;QACzD,SAAS,OAAO,CAAC,GAAG,CAAC,2BAA2B;QAEhD,8CAA8C;QAC9C,IAAI,iBAAiB,QAAQ,GAAG,CAAC,cAAc,KAAK,QAAQ;YAC1D,gJAAA,CAAA,SAAM,CAAC,IAAI,CAAC,eAAe;gBAAE;gBAAW;YAAM;QAChD;IACF;IAEA,mDAAmD;IACnD,SAAS,OAAO,CAAC,GAAG,CAAC,eAAe;IAEpC,yFAAyF;IACzF,mFAAmF;IACnF,uBAAuB;IACvB,4EAA4E;IAC5E,IAAI;IAEJ,yCAAyC;IACzC;;IAKA,4BAA4B;IAC5B,SAAS,OAAO,CAAC,GAAG,CAAC,mBAAmB;IACxC,SAAS,OAAO,CAAC,GAAG,CAAC,0BAA0B;IAC/C,SAAS,OAAO,CAAC,GAAG,CAAC,oBAAoB;IACzC,SAAS,OAAO,CAAC,GAAG,CAAC,mBAAmB;IAExC,8BAA8B;IAC9B,MAAM,0BAA0B;IAChC,SAAS,OAAO,CAAC,GAAG,CAAC,sBAAsB;IAE3C,wBAAwB;IACxB,SAAS,OAAO,CAAC,GAAG,CAAC,gCAAgC,yBAAyB,YAAY,CAAC,cAAc;IACzG,SAAS,OAAO,CAAC,GAAG,CAAC,8BAA8B,yBAAyB,YAAY,CAAC,YAAY;IACrG,SAAS,OAAO,CAAC,GAAG,CAAC,gCAAgC,yBAAyB,YAAY,CAAC,cAAc;IAEzG,8BAA8B;IAC9B,SAAS,OAAO,CAAC,GAAG,CAAC,sBAAsB,WAAW,cAAc;IACpE,SAAS,OAAO,CAAC,GAAG,CAAC,qCAAqC,SAAS,kBAAkB;IACrF,SAAS,OAAO,CAAC,GAAG,CAAC,0BAA0B;IAE/C,2BAA2B;IAC3B;;IAIA,4BAA4B;IAC5B,SAAS,OAAO,CAAC,MAAM,CAAC;IACxB,SAAS,OAAO,CAAC,MAAM,CAAC;IAExB,2CAA2C;IAC3C,IAAI,iBAAiB,QAAQ,OAAO,CAAC,QAAQ,GAAG;QAC9C,SAAS,OAAO,CAAC,GAAG,CAAC,iBAAiB;QACtC,SAAS,OAAO,CAAC,GAAG,CAAC,UAAU;QAC/B,SAAS,OAAO,CAAC,GAAG,CAAC,WAAW;QAChC,SAAS,OAAO,CAAC,GAAG,CAAC,qBAAqB;IAC5C,OAAO;QACL,SAAS,OAAO,CAAC,GAAG,CAAC,iBAAiB;IACxC;IAEA,oCAAoC;IACpC,wCAAmB;QACjB,SAAS,OAAO,CAAC,GAAG,CAAC,oBAAoB;IACzC,uEAAuE;IACzE;IAEA,OAAO;AACT;AAEA;;CAEC,GACD,SAAS,iBAAiB,QAAgB;IACxC,MAAM,oBAAoB;QACxB;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IAED,OAAO,kBAAkB,IAAI,CAAC,CAAA,UAAW,QAAQ,IAAI,CAAC;AACxD;AAEA;;CAEC,GACD,SAAS;IACP,MAAM,MAAM,KAAK,GAAG;IACpB,KAAK,MAAM,CAAC,KAAK,KAAK,IAAI,WAAW,OAAO,GAAI;QAC9C,IAAI,KAAK,OAAO,GAAG,KAAK;YACtB,WAAW,MAAM,CAAC;QACpB;IACF;AACF;AAEA,yBAAyB;AACzB,YAAY,sBAAsB,KAAK,KAAK,OAAO,mBAAmB;AAK/D,SAAS;IACd,wCAAmC,OAAO;;;IAE1C,iCAAiC;IACjC,MAAM;AAKR;AAMO,SAAS;IACd,wCAAmC;QACjC,+DAA+D;QAC/D,OAAO;IACT;;;AAIF;AAKO,SAAS,mBAAmB,GAAW,EAAE,KAAc;IAC5D,MAAM,SAAS,SAAS,aAAa,CAAC;IACtC,OAAO,GAAG,GAAG;IACb,IAAI,OAAO;QACT,OAAO,KAAK,GAAG;IACjB;IACA,OAAO;AACT;AAKO,SAAS,yBAAyB,OAAe,EAAE,KAAc;IACtE,MAAM,SAAS,SAAS,aAAa,CAAC;IACtC,OAAO,WAAW,GAAG;IACrB,IAAI,OAAO;QACT,OAAO,KAAK,GAAG;IACjB;IACA,OAAO;AACT;AAqBO,SAAS,mBAAmB,eAAmC;IACpE,gJAAA,CAAA,SAAM,CAAC,IAAI,CAAC,mBAAmB;QAC7B,YAAY,gBAAgB,UAAU;QACtC,aAAa,gBAAgB,WAAW;QACxC,oBAAoB,gBAAgB,kBAAkB;QACtD,gBAAgB,gBAAgB,cAAc;QAC9C,UAAU,gBAAgB,QAAQ;QAClC,mBAAmB,gBAAgB,iBAAiB;QACpD,WAAW,IAAI,OAAO,WAAW;IACnC;IAEA,4CAA4C;IAC5C,IAAI,oDAAyB,cAAc;IACzC,iCAAiC;IACjC,oBAAoB;IACpB,qDAAqD;IACrD,0CAA0C;IAC1C,2BAA2B;IAC7B;AACF;AAKO,SAAS;IACd,wCAAmC;;;AAYrC"}},
    {"offset": {"line": 468, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/apps/frontend/src/middleware.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from 'next/server'\nimport { applyEnhancedSecurityHeaders } from '@/lib/security/enhanced-security-headers'\n\nexport function middleware(request: NextRequest) {\n  // Create response\n  const response = NextResponse.next()\n  \n  // Apply security headers\n  applyEnhancedSecurityHeaders(response, request)\n  \n  return response\n}\n\n// Configure which routes the middleware should run on\nexport const config = {\n  matcher: [\n    /*\n     * Match all request paths except for the ones starting with:\n     * - _next/static (static files) - CRITICAL: Don't apply CSP to Next.js chunks\n     * - _next/image (image optimization files)\n     * - _next/ (all Next.js internal routes)\n     * - api routes (API endpoints)\n     * - favicon.ico (favicon file)  \n     * - public folder files\n     * - files with extensions (css, js, json, xml, etc.)\n     */\n    '/((?!api/|_next/|favicon.ico|sitemap.xml|robots.txt|.*\\\\.(?:svg|png|jpg|jpeg|gif|webp|css|js|json|xml|ico|woff|woff2|ttf|eot)$).*)',\n  ],\n}"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;;;AAEO,SAAS,WAAW,OAAoB;IAC7C,kBAAkB;IAClB,MAAM,WAAW,6LAAA,CAAA,eAAY,CAAC,IAAI;IAElC,yBAAyB;IACzB,CAAA,GAAA,qLAAA,CAAA,+BAA4B,AAAD,EAAE,UAAU;IAEvC,OAAO;AACT;AAGO,MAAM,SAAS;IACpB,SAAS;QACP;;;;;;;;;KASC,GACD;KACD;AACH"}}]
}