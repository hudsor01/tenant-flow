"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2816],{217:(e,t,r)=>{r.d(t,{ND:()=>c});var a=r(35415),n=r(95048);let s={NEXT_PUBLIC_SUPABASE_URL:"https://bshjmbshupiibfiewpxb.supabase.co",NEXT_PUBLIC_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJzaGptYnNodXBpaWJmaWV3cHhiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg0MDc1MDYsImV4cCI6MjA2Mzk4MzUwNn0.K9cR4SN_MtutRWPJsymtAtlHpEJFyfnQgtu8BjQRqko"},i=s.NEXT_PUBLIC_SUPABASE_URL,l=s.NEXT_PUBLIC_SUPABASE_ANON_KEY,o=null,u=null,c={get client(){if(o)return o;if(!i||!l)throw Error("Supabase environment variables are not set.");return o=(0,n.UU)(i,l)}}.client,p={get client(){if(u)return u;if(!i||!l)throw Error("Supabase environment variables are not set for anon client.");return u=(0,n.UU)(i,l,{auth:{persistSession:!1,autoRefreshToken:!1,detectSessionInUrl:!1}})}}.client;class d{get client(){if(!c)throw Error("Supabase client is not initialized. Please check that NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY environment variables are set.");return c}get anonClient(){if(!p)throw Error("Supabase anonymous client is not initialized. Please check that NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY environment variables are set.");return p}get auth(){return this.client.auth}from(e){return this.client.from(e)}get storage(){return this.client.storage}channel(e){return this.client.channel(e)}get anon(){return{from:e=>this.anonClient.from(e),auth:this.anonClient.auth,storage:this.anonClient.storage}}get isAvailable(){return null!==c}getRawClient(){return this.client}getRawAnonClient(){return this.anonClient}}new d,new a.E1({defaultOptions:{queries:{staleTime:3e5,gcTime:6e5,retry:(e,t)=>{var r,a;return!((null==t||null==(r=t.message)?void 0:r.includes("40"))||(null==t||null==(a=t.message)?void 0:a.includes("Unauthorized")))&&e<3},retryDelay:e=>Math.min(1e3*2**e,3e4)},mutations:{retry:!1}}})},3519:(e,t,r)=>{r.d(t,{v:()=>a});let a={debug:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a]},info:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];console.info("[INFO] ".concat(e),...r)},warn:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];console.warn("[WARN] ".concat(e),...r)},error:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];console.error("[ERROR] ".concat(e),...r)}}},18803:(e,t,r)=>{r.d(t,{u:()=>a.A});var a=r(12463)},67832:(e,t,r)=>{r.d(t,{s:()=>s});var a=r(89240),n=r(7620);function s(){let e=(0,a.sf)(),t=(0,n.useCallback)((t,r)=>{if(!e)return;let a={...r,app_version:"1.0.0",environment:"production",timestamp:new Date().toISOString()};e.capture(t,a)},[e]),r=(0,n.useCallback)((t,r)=>{e&&t&&e.identify(t.id,{email:t.email,created_at:t.createdAt,organization_id:r})},[e]),s=(0,n.useCallback)(()=>{e&&e.reset()},[e]),i=(0,n.useCallback)((t,r,a)=>{e&&e.capture("conversion_goal",{goal_name:t,goal_value:r,...a})},[e]),l=(0,n.useCallback)((t,r)=>{if(!e)return;let a=t instanceof Error?t.message:String(t),n=t instanceof Error?t.stack:void 0;e.capture("error_occurred",{error_message:a,error_stack:n,error_type:t instanceof Error?t.name:"UnknownError",...r})},[e]),o=(0,n.useCallback)(function(t){var r;let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e&&null!=(r=e.isFeatureEnabled(t))?r:a},[e]),u=(0,n.useCallback)(t=>e?e.getFeatureFlagPayload(t):null,[e]),c=(0,n.useCallback)((t,r,a,n)=>{e&&e.capture("timing_metric",{timing_category:t,timing_variable:r,timing_time:a,timing_label:n})},[e]);return{posthog:e,trackEvent:t,identifyUser:r,resetUser:s,trackConversion:i,trackError:l,isFeatureEnabled:o,getFeatureFlagPayload:u,trackTiming:c}}},80951:(e,t,r)=>{r.d(t,{As:()=>B.A,$l:()=>q.$});var a=r(57393);r(18991);let n=(0,a.eU)([]),s=(0,a.eU)([]);(0,a.eU)(null,(e,t,r)=>{let a={event:"property_".concat(r.type),properties:{propertyId:r.property.id,propertyType:r.property.propertyType,city:r.property.city},timestamp:Date.now()},i=e(n);if(t(n,[...i,a]),"view"!==r.type){let a={type:"delete"===r.type?"info":"success",message:"Property ".concat("create"===r.type?"created":"update"===r.type?"updated":"deleted"," successfully"),duration:3e3},n=e(s);t(s,[...n,a])}}),(0,a.eU)(null,(e,t,r)=>{let a={event:"error_occurred",properties:{message:r.message,stack:r.stack,context:r.context,url:window.location.href},timestamp:Date.now()},i=e(n);t(n,[...i,a]);let l={type:"error",message:r.message,duration:5e3},o=e(s);t(s,[...o,l])}),(0,a.eU)(null,(e,t)=>{t(n,[])}),(0,a.eU)(null,(e,t)=>{t(s,[])}),(0,a.eU)(null,(e,t,r)=>{let a=e(s);t(s,a.filter((e,t)=>t!==r))}),(0,a.eU)(e=>e(s).length),(0,a.eU)(e=>e(n).length);var i=r(96646);(0,i.tG)("tenantflow-theme","system");let l=(0,i.tG)("tenantflow-sidebar-open",!0);(0,a.eU)(!0);let o=(0,i.tG)("tenantflow-feature-flags",{darkMode:!0,betaFeatures:!1,analyticsEnabled:!0});(0,a.eU)(null,(e,t)=>{let r=e(l);t(l,!r)}),(0,a.eU)(null,(e,t,r)=>{let a=e(o);t(o,{...a,[r]:!a[r]})});let u=(0,a.eU)([]);(0,a.eU)(null,(e,t,r)=>{let a={...r,id:Math.random().toString(36).substring(2)+Date.now().toString(36),timestamp:Date.now()},n=e(u);t(u,[...n,a]),("success"===r.type||"info"===r.type)&&setTimeout(()=>{let r=e(u);t(u,r.filter(e=>e.id!==a.id))},5e3)}),(0,a.eU)(null,(e,t,r)=>{let a=e(u);t(u,a.filter(e=>e.id!==r))}),(0,a.eU)(null,(e,t)=>{t(u,[])}),(0,a.eU)(e=>e(u).filter(e=>"error"===e.type||"warning"===e.type));let c={propertyForm:!1,unitForm:!1,leaseForm:!1,maintenanceForm:!1,editProperty:!1,editUnit:!1,editLease:!1,editMaintenance:!1,inviteTenant:!1,subscriptionCheckout:!1,subscriptionSuccess:!1},p=(0,a.eU)(c);(0,a.eU)(null,(e,t,r)=>{let a=e(p);t(p,{...a,[r]:!0})}),(0,a.eU)(null,(e,t,r)=>{let a=e(p);t(p,{...a,[r]:!1})}),(0,a.eU)(null,(e,t)=>{t(p,c)});var d=r(75992);let y=(0,d.EQ)({name:"",address:"",city:"",state:"",zipCode:"",propertyType:"SINGLE_FAMILY",units:[],isEditing:!1,validationErrors:{},isDirty:!1}),g=(0,d.EQ)({name:"",email:"",phone:"",emergencyContact:"",propertyId:"",unitId:"",leaseStartDate:"",leaseEndDate:"",monthlyRent:0,securityDeposit:0,isEditing:!1,validationErrors:{},isDirty:!1});(0,i.tx)(y),(0,i.tx)(g),(0,a.eU)(e=>{var t,r;let a=e(y);return 0===Object.keys(a.validationErrors).length&&(null==(t=a.name)?void 0:t.trim())&&(null==(r=a.address)?void 0:r.trim())}),(0,a.eU)(e=>{var t,r;let a=e(g);return 0===Object.keys(a.validationErrors).length&&(null==(t=a.name)?void 0:t.trim())&&(null==(r=a.email)?void 0:r.trim())}),(0,a.eU)(null,(e,t,r,a)=>{t(y,e=>{e[r]=a,e.isDirty=!0,e.validationErrors[r]&&delete e.validationErrors[r]})}),(0,a.eU)(null,(e,t,r,a)=>{t(y,e=>{e.validationErrors[r]=a})}),(0,a.eU)(null,(e,t)=>{t(y,e=>{e.validationErrors={}})}),(0,a.eU)(null,(e,t,r,a)=>{t(g,e=>{("string"==typeof a||"number"==typeof a||"boolean"==typeof a)&&(e[r]=a),e.isDirty=!0,e.validationErrors[r]&&delete e.validationErrors[r]})}),(0,a.eU)(null,(e,t,r)=>{t(y,e=>{Object.assign(e,r),e.isEditing=!0,e.isDirty=!1,e.validationErrors={}})}),(0,a.eU)(null,(e,t,r)=>{t(g,e=>{Object.assign(e,r),e.isEditing=!0,e.isDirty=!1,e.validationErrors={}})});var m=r(94398),U=r(39879);let f={properties:{list:e=>U.u.get("/properties",{params:e}),get:e=>U.u.get("/properties/".concat(e)),create:e=>U.u.post("/properties",e),update:(e,t)=>U.u.put("/properties/".concat(e),t),delete:e=>U.u.delete("/properties/".concat(e)),stats:()=>U.u.get("/properties/stats"),uploadImage:(e,t)=>U.u.post("/properties/".concat(e,"/upload-image"),t,{headers:{"Content-Type":"multipart/form-data"}}),getUnits:e=>U.u.get("/properties/".concat(e,"/units")),getTenants:e=>U.u.get("/properties/".concat(e,"/tenants")),getLeases:e=>U.u.get("/properties/".concat(e,"/leases")),getMaintenance:e=>U.u.get("/properties/".concat(e,"/maintenance"))},tenants:{list:e=>U.u.get("/tenants",{params:e}),get:e=>U.u.get("/tenants/".concat(e)),create:e=>U.u.post("/tenants",e),update:(e,t)=>U.u.put("/tenants/".concat(e),t),delete:e=>U.u.delete("/tenants/".concat(e)),stats:()=>U.u.get("/tenants/stats"),uploadDocument:(e,t)=>U.u.post("/tenants/".concat(e,"/documents"),t,{headers:{"Content-Type":"multipart/form-data"}}),getLeases:e=>U.u.get("/tenants/".concat(e,"/leases")),getPayments:e=>U.u.get("/tenants/".concat(e,"/payments")),getMaintenance:e=>U.u.get("/tenants/".concat(e,"/maintenance")),getDocuments:e=>U.u.get("/tenants/".concat(e,"/documents")),inviteTenant:(e,t)=>U.u.post("/tenants/".concat(e,"/invite"),{email:t})}};class h{static async getProperties(e){let t=await f.properties.list(e);return t.data.data||t.data}static async getPropertyStats(){return(await f.properties.stats()).data}static async getProperty(e){return(await f.properties.get(e)).data}static async createProperty(e){return(await f.properties.create(e)).data}static async updateProperty(e,t){return(await f.properties.update(e,t)).data}static async deleteProperty(e){return(await f.properties.delete(e)).data}static async uploadPropertyImage(e,t){let r=new FormData;return r.append("image",t),(await f.properties.uploadImage(e,r)).data}static async getPropertyUnits(e){return(await f.properties.getUnits(e)).data}static async getPropertyTenants(e){return(await f.properties.getTenants(e)).data}static async getPropertyLeases(e){return(await f.properties.getLeases(e)).data}static async getPropertyMaintenance(e){return(await f.properties.getMaintenance(e)).data}}let v=(0,a.eU)(null),E=(0,i.tx)({}),w=(0,m.qA)(()=>({queryKey:["properties"],queryFn:()=>h.getProperties()}));(0,m.qA)(()=>({queryKey:["property-stats"],queryFn:()=>h.getPropertyStats()}));let A=(0,a.eU)(e=>e(w).data||[]);(0,a.eU)(e=>e(A).length),(0,a.eU)(e=>[...new Set(e(A).map(e=>e.city).filter(e=>!!e))]),(0,a.eU)(["SINGLE_FAMILY","APARTMENT","CONDO","TOWNHOUSE","OTHER"]),(0,a.eU)(e=>{let t=e(A),r=e(E);return t.filter(e=>{if(r.city&&e.city!==r.city||r.propertyType&&e.propertyType!==r.propertyType)return!1;if(r.searchQuery){let t=r.searchQuery.toLowerCase();return e.name.toLowerCase().includes(t)||e.address.toLowerCase().includes(t)}return!0})}),(0,a.eU)(e=>e(A).reduce((e,t)=>{let r=t.city||"Unknown";return e[r]||(e[r]=[]),e[r].push(t),e},{})),(0,a.eU)(e=>e(A).reduce((e,t)=>{var r;return e+((null==(r=t.units)?void 0:r.filter(e=>"VACANT"===e.status).length)||0)},0)),(0,a.eU)(null,(e,t,r)=>{let a=e(E);t(E,{...a,...r})}),(0,a.eU)(null,(e,t,r)=>{t(E,e=>({}))}),(0,a.eU)(null,(e,t,r)=>{t(v,r)});class _{static async getTenants(e){let t=await f.tenants.list(e);return t.data.data||t.data}static async getTenantStats(){return(await f.tenants.stats()).data}static async getTenant(e){return(await f.tenants.get(e)).data}static async createTenant(e){return(await f.tenants.create(e)).data}static async updateTenant(e,t){return(await f.tenants.update(e,t)).data}static async deleteTenant(e){return(await f.tenants.delete(e)).data}static async uploadDocument(e,t,r){let a=new FormData;return a.append("document",t),a.append("type",r),(await f.tenants.uploadDocument(e,a)).data}static async getTenantLeases(e){return(await f.tenants.getLeases(e)).data}static async getTenantPayments(e){return(await f.tenants.getPayments(e)).data}static async getTenantMaintenance(e){return(await f.tenants.getMaintenance(e)).data}static async getTenantDocuments(e){return(await f.tenants.getDocuments(e)).data}static async inviteTenant(e,t){return(await f.tenants.inviteTenant(e,t)).data}}let P=(0,a.eU)([]),T=(0,a.eU)(null),S=(0,a.eU)({}),C=(0,a.eU)(!1);(0,a.eU)(!1);let b=(0,a.eU)(null);(0,m.qA)(()=>({queryKey:["tenants"],queryFn:()=>_.getTenants()}));let I=(0,a.eU)(0);(0,a.eU)(e=>{let t=e(P),r=e(S);return t.filter(e=>{if(r.status&&e.invitationStatus!==r.status)return!1;if(r.searchQuery){let t=r.searchQuery.toLowerCase();return e.name.toLowerCase().includes(t)||e.email.toLowerCase().includes(t)}return!0})}),(0,a.eU)(e=>e(P).filter(e=>"ACCEPTED"===e.invitationStatus)),(0,a.eU)(()=>({})),(0,a.eU)(e=>e(P).reduce((e,t)=>{let r=t.invitationStatus;return e[r]||(e[r]=0),e[r]++,e},{})),(0,a.eU)(null,(e,t,r)=>{t(P,r),t(I,r.length)}),(0,a.eU)(null,(e,t,r)=>{let a=e(P);t(P,[r,...a]),t(I,a.length+1)}),(0,a.eU)(null,(e,t,r)=>{let a=e(P).map(e=>e.id===r.id?{...e,...r}:e);t(P,a);let n=e(T);(null==n?void 0:n.id)===r.id&&t(T,{...n,...r})}),(0,a.eU)(null,(e,t,r)=>{let a=e(P).filter(e=>e.id!==r);t(P,a),t(I,a.length);let n=e(T);(null==n?void 0:n.id)===r&&t(T,null)}),(0,a.eU)(null,(e,t,r)=>{let a=e(S);t(S,{...a,...r})}),(0,a.eU)(null,(e,t)=>{t(S,{})}),(0,a.eU)(null,(e,t,r)=>{t(T,r)}),(0,a.eU)(null,(e,t,r)=>{t(C,r)}),(0,a.eU)(null,(e,t,r)=>{t(b,r)});let L=async()=>{let e=await fetch("/api/properties");if(!e.ok)throw Error("Failed to fetch properties");return e.json()},k=async()=>{let e=await fetch("/api/tenants");if(!e.ok)throw Error("Failed to fetch tenants");return e.json()};(0,m.qA)(()=>({queryKey:["properties"],queryFn:L,staleTime:3e5,gcTime:6e5})),(0,m.qA)(()=>({queryKey:["tenants"],queryFn:k,staleTime:3e5,gcTime:6e5}));let N={properties:{all:["properties"],lists:()=>[...N.properties.all,"list"],list:e=>[...N.properties.lists(),{filters:e}],details:()=>[...N.properties.all,"detail"],detail:e=>[...N.properties.details(),e]},tenants:{all:["tenants"],lists:()=>[...N.tenants.all,"list"],list:e=>[...N.tenants.lists(),{filters:e}],details:()=>[...N.tenants.all,"detail"],detail:e=>[...N.tenants.details(),e]}},D=(0,m.vy)(()=>({mutationFn:h.createProperty,onSuccess:()=>{},onError:e=>{console.error("Failed to create property:",e)}})),F=(0,m.vy)(()=>({mutationFn:e=>{let{id:t,data:r}=e;return h.updateProperty(t,r)},onSuccess:()=>{},onError:e=>{console.error("Failed to update property:",e)}})),R=(0,m.vy)(()=>({mutationFn:e=>h.deleteProperty(e),onSuccess:()=>{},onError:e=>{console.error("Failed to delete property:",e)}}));(0,a.eU)(null,async(e,t,r)=>{try{var a,n,s;switch(r.type){case"create":{let t=e(D),n=await t.mutateAsync(r.data),s=e(w);return null==(a=s.refetch)||a.call(s),{success:!0,data:n}}case"update":{let t=e(F),a=await t.mutateAsync({id:r.id,data:r.data}),s=e(w);return null==(n=s.refetch)||n.call(s),{success:!0,data:a}}case"delete":{let t=e(R);await t.mutateAsync(r.id);let a=e(w);return null==(s=a.refetch)||s.call(a),{success:!0}}default:throw Error("Invalid property action type")}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}});let M=(0,a.eU)(e=>{let t=e(D),r=e(F),a=e(R);return{creating:t.isPending,updating:r.isPending,deleting:a.isPending,isAnyLoading:t.isPending||r.isPending||a.isPending}}),O=(0,a.eU)(e=>{let t=e(D),r=e(F),a=e(R);return{createError:t.error?String(t.error):null,updateError:r.error?String(r.error):null,deleteError:a.error?String(a.error):null,hasAnyError:!!(t.error||r.error||a.error)}});(0,a.eU)(null,(e,t)=>{let r=e(D),a=e(F),n=e(R);r.reset(),a.reset(),n.reset()}),(0,a.eU)(e=>{let t=e(D),r=e(F),a=e(R),n=e(M),s=e(O);return{createProperty:t.mutateAsync,updateProperty:r.mutateAsync,deleteProperty:a.mutateAsync,...n,...s,resetCreate:t.reset,resetUpdate:r.reset,resetDelete:a.reset}});var B=r(98071);r(7620),r(51874),(0,a.eU)({data:[],isLoading:!1,error:null,refetch:()=>{}}),(0,a.eU)(null),(0,a.eU)({data:[],isLoading:!1,error:null,refetch:()=>{}}),(0,a.eU)(null);var q=r(87072);r(62942),r(217),r(3519)},87072:(e,t,r)=>{r.d(t,{$:()=>i});var a=r(7620),n=r(62942),s=r(51874);function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},[r,i]=(0,a.useTransition)(),l=(0,n.useRouter)(),{onSuccess:o,onError:u,showSuccessToast:c=!0,showErrorToast:p=!0,successMessage:d="Action completed successfully",revalidatePath:y}=t;return[(0,a.useCallback)(async function(){for(var t=arguments.length,r=Array(t),a=0;a<t;a++)r[a]=arguments[a];return new Promise(t=>{i(async()=>{try{let i=await e(...r);if(i.success)c&&s.oR.success(i.message||d),y&&l.push(y),null==o||o(i.data);else{var a,n;let e=(null==(n=i.errors)||null==(a=n._form)?void 0:a[0])||i.message||"Action failed";p&&s.oR.error(e),null==u||u(e)}t(i)}catch(r){let e=r instanceof Error?r.message:"An unexpected error occurred";p&&s.oR.error(e),null==u||u(e),t({success:!1,message:e,errors:{_form:[e]}})}})})},[e,o,u,c,p,d,y,l]),r]}}}]);