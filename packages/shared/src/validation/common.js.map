{"version":3,"file":"common.js","sourceRoot":"","sources":["common.ts"],"names":[],"mappings":";;;AAoDA,oCAGC;AAKD,gCAqBC;AAKD,wDAGC;AApFD,6BAAuB;AACvB,4DAAkE;AAGrD,QAAA,WAAW,GAAG,OAAC,CAAC,MAAM,EAAE,CAAC,KAAK,CAAC,oCAAoC,CAAC,CAAA;AAGpE,QAAA,cAAc,GAAG,OAAC,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,CAAC,EAAE,wBAAwB,CAAC,CAAA;AAG5D,QAAA,oBAAoB,GAAG,OAAC,CAAC,MAAM,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC,EAAE,4BAA4B,CAAC,CAAA;AAG7E,QAAA,aAAa,GAAG,OAAC,CAAC,MAAM,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC,EAAE,mBAAmB,CAAC,CAAC,GAAG,CAAC,2BAAiB,CAAC,gBAAgB,EAAE,uBAAuB,2BAAiB,CAAC,gBAAgB,aAAa,CAAC,CAAA;AAG7K,QAAA,mBAAmB,GAAG,OAAC,CAAC,MAAM,EAAE,CAAC,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC,EAAE,yBAAyB,CAAC,CAAC,GAAG,CAAC,2BAAiB,CAAC,sBAAsB,EAAE,6BAA6B,2BAAiB,CAAC,sBAAsB,aAAa,CAAC,CAAA;AAG3M,QAAA,UAAU,GAAG,OAAC,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAA;AAGnD,QAAA,SAAS,GAAG,OAAC,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,oBAAoB,CAAC,CAAC,MAAM,CACnE,CAAC,GAAG,EAAE,EAAE,CAAC,UAAU,CAAC,GAAG,CAAC,EACxB,EAAE,OAAO,EAAE,kCAAkC,EAAE,CAC/C,CAAA;AAGY,QAAA,uBAAuB,GAAG,OAAC,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,CAAC,EAAE,4BAA4B,CAAC,CAAA;AAGzE,QAAA,oBAAoB,GAAG,OAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,wBAAwB,CAAC,CAAA;AAGpE,QAAA,WAAW,GAAG,OAAC;KAC1B,MAAM,EAAE;KACR,KAAK,CAAC,eAAe,EAAE,4DAA4D,CAAC;KACpF,GAAG,CAAC,EAAE,EAAE,6CAA6C,CAAC;KACtD,GAAG,CAAC,2BAAiB,CAAC,6BAA6B,EAAE,8BAA8B,2BAAiB,CAAC,6BAA6B,aAAa,CAAC,CAAA;AASlJ,SAAgB,YAAY,CAAC,KAAa;IACzC,MAAM,UAAU,GAAG,4BAA4B,CAAA;IAC/C,OAAO,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC,MAAM,IAAI,GAAG,CAAA;AACrD,CAAC;AAKD,SAAgB,UAAU,CAAC,GAAW;IACrC,IAAI,CAAC;QACJ,MAAM,SAAS,GAAG,IAAI,GAAG,CAAC,GAAG,CAAC,CAAA;QAG9B,IAAI,CAAC,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC,QAAQ,CAAC,SAAS,CAAC,QAAQ,CAAC,EAAE,CAAC;YACvD,OAAO,KAAK,CAAA;QACb,CAAC;QAGD,IACC,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,KAAK,YAAY;YACxC,CAAC,SAAS,CAAC,QAAQ,KAAK,WAAW,IAAI,SAAS,CAAC,QAAQ,KAAK,WAAW,CAAC,EACzE,CAAC;YACF,OAAO,KAAK,CAAA;QACb,CAAC;QAED,OAAO,IAAI,CAAA;IACZ,CAAC;IAAC,MAAM,CAAC;QACR,OAAO,KAAK,CAAA;IACb,CAAC;AACF,CAAC;AAKD,SAAgB,sBAAsB,CAAC,SAAiB;IACvD,MAAM,cAAc,GAAG,yBAAyB,CAAA;IAChD,OAAO,cAAc,CAAC,IAAI,CAAC,SAAS,CAAC,CAAA;AACtC,CAAC","sourcesContent":["/**\n * Common validation schemas and functions\n * Shared across frontend and backend for consistency\n */\n\nimport { z } from 'zod'\nimport { VALIDATION_LIMITS } from '@repo/shared/constants/billing'\n\n/** Email validation schema */\nexport const emailSchema = z.string().email('Please enter a valid email address')\n\n/** Required non-empty string schema */\nexport const requiredString = z.string().min(1, 'This field is required')\n\n/** Non-empty string schema with trimming */\nexport const nonEmptyStringSchema = z.string().trim().min(1, 'This field cannot be empty')\n\n/** Required title schema (1-200 characters) */\nexport const requiredTitle = z.string().trim().min(1, 'Title is required').max(VALIDATION_LIMITS.TITLE_MAX_LENGTH, `Title cannot exceed ${VALIDATION_LIMITS.TITLE_MAX_LENGTH} characters`)\n\n/** Required description schema (1-2000 characters) */\nexport const requiredDescription = z.string().trim().min(1, 'Description is required').max(VALIDATION_LIMITS.DESCRIPTION_MAX_LENGTH, `Description cannot exceed ${VALIDATION_LIMITS.DESCRIPTION_MAX_LENGTH} characters`)\n\n/** UUID validation schema */\nexport const uuidSchema = z.string().uuid('Invalid UUID format')\n\n/** URL validation schema with custom validator */\nexport const urlSchema = z.string().url('Invalid URL format').refine(\n\t(url) => isValidUrl(url),\n\t{ message: 'URL must use http/https protocol' }\n)\n\n/** Non-negative number schema (>= 0) */\nexport const nonNegativeNumberSchema = z.number().min(0, 'Value must be non-negative')\n\n/** Positive number schema (> 0) */\nexport const positiveNumberSchema = z.number().positive('Value must be positive')\n\n/** Phone number validation schema */\nexport const phoneSchema = z\n\t.string()\n\t.regex(/^[\\d+()-\\s]+$/, 'Phone number can only contain digits, +, (), -, and spaces')\n\t.min(10, 'Phone number must be at least 10 characters')\n\t.max(VALIDATION_LIMITS.CONTACT_FORM_PHONE_MAX_LENGTH, `Phone number cannot exceed ${VALIDATION_LIMITS.CONTACT_FORM_PHONE_MAX_LENGTH} characters`)\n\n// ============================================================================\n// VALIDATION FUNCTIONS\n// ============================================================================\n\n/**\n * Validate email format\n */\nexport function isValidEmail(email: string): boolean {\n\tconst emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/\n\treturn emailRegex.test(email) && email.length <= 254\n}\n\n/**\n * Validate URL format and security\n */\nexport function isValidUrl(url: string): boolean {\n\ttry {\n\t\tconst parsedUrl = new URL(url)\n\n\t\t// Only allow http and https protocols\n\t\tif (!['http:', 'https:'].includes(parsedUrl.protocol)) {\n\t\t\treturn false\n\t\t}\n\n\t\t// Prevent localhost in production\n\t\tif (\n\t\t\tprocess.env[\"NODE_ENV\"] === 'production' &&\n\t\t\t(parsedUrl.hostname === 'localhost' || parsedUrl.hostname === '127.0.0.1')\n\t\t) {\n\t\t\treturn false\n\t\t}\n\n\t\treturn true\n\t} catch {\n\t\treturn false\n\t}\n}\n\n/**\n * Validate Stripe session ID format\n */\nexport function isValidStripeSessionId(sessionId: string): boolean {\n\tconst sessionIdRegex = /^cs_[a-zA-Z0-9_-]{24,}$/\n\treturn sessionIdRegex.test(sessionId)\n}"]}