{"version":3,"file":"maintenance.js","sourceRoot":"","sources":["maintenance.ts"],"names":[],"mappings":"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","sourcesContent":["import { z } from 'zod'\nimport { Constants } from '../types/supabase-generated.js'\nimport {\n\tnonEmptyStringSchema,\n\tnonNegativeNumberSchema,\n\trequiredString,\n\tuuidSchema\n} from './common.js'\n\n// Maintenance priority enum - uses auto-generated Supabase enums\nexport const maintenancePrioritySchema = z.enum(\n\tConstants.public.Enums.Priority as readonly [string, ...string[]]\n)\n\n// Maintenance status enum - uses auto-generated Supabase enums\nexport const maintenanceStatusSchema = z.enum(\n\tConstants.public.Enums.RequestStatus as readonly [string, ...string[]]\n)\n\n// Maintenance category enum - uses auto-generated Supabase enums\nexport const maintenanceCategorySchema = z.enum(\n\tConstants.public.Enums.MaintenanceCategory as readonly [string, ...string[]]\n)\n\n// Base maintenance request input schema (for forms and API creation)\nexport const maintenanceRequestInputSchema = z.object({\n\ttitle: nonEmptyStringSchema\n\t\t.min(5, 'Title must be at least 5 characters')\n\t\t.max(200, 'Title cannot exceed 200 characters'),\n\n\tdescription: nonEmptyStringSchema\n\t\t.min(10, 'Description must be at least 10 characters')\n\t\t.max(2000, 'Description cannot exceed 2000 characters'),\n\n\tpriority: maintenancePrioritySchema.default('MEDIUM' as const),\n\n\tcategory: z.string().optional(), // Database shows this as string | null, not enum\n\n\tunitId: uuidSchema,\n\n\t// Optional assignment\n\tassignedTo: uuidSchema.optional(),\n\n\t// Request details\n\trequestedBy: uuidSchema.optional(),\n\tcontactPhone: z.string().optional(),\n\tallowEntry: z.boolean().optional().default(false),\n\n\t// Cost information\n\testimatedCost: nonNegativeNumberSchema\n\t\t.max(1000000, 'Estimated cost seems unrealistic')\n\t\t.optional(),\n\n\t// Photos/attachments (database field is 'photos', not 'images')\n\tphotos: z.array(z.string()).optional().default([]),\n\n\t// Additional notes\n\tnotes: z.string().max(1000, 'Notes cannot exceed 1000 characters').optional(),\n\n\t// Preferred completion date (database field is 'preferredDate', not 'scheduledDate')\n\tpreferredDate: z\n\t\t.string()\n\t\t.optional()\n\t\t.refine((val: string | undefined) => !val || !isNaN(Date.parse(val)), {\n\t\t\tmessage: 'Please enter a valid preferred date'\n\t\t})\n\t\t.transform((val: string | undefined) => (val ? new Date(val) : undefined))\n})\n\n// Full maintenance request schema (includes server-generated fields)\nexport const maintenanceRequestSchema = maintenanceRequestInputSchema.extend({\n\tid: uuidSchema,\n\tstatus: maintenanceStatusSchema.default('OPEN' as const),\n\n\t// Completion info\n\tcompletedAt: z.date().optional(),\n\tactualCost: nonNegativeNumberSchema.optional(),\n\n\tcreatedAt: z.date(),\n\tupdatedAt: z.date()\n})\n\n// Maintenance request update schema (partial input)\nexport const maintenanceRequestUpdateSchema = maintenanceRequestInputSchema\n\t.partial()\n\t.extend({\n\t\tstatus: maintenanceStatusSchema.optional(),\n\t\tactualCost: nonNegativeNumberSchema.optional(),\n\t\tcompletedAt: z\n\t\t\t.string()\n\t\t\t.optional()\n\t\t\t.refine((val: string | undefined) => !val || !isNaN(Date.parse(val)), {\n\t\t\t\tmessage: 'Please enter a valid completion date'\n\t\t\t})\n\t\t\t.transform((val: string | undefined) => (val ? new Date(val) : undefined))\n\t})\n\n// Maintenance request query schema (for search/filtering)\nexport const maintenanceRequestQuerySchema = z.object({\n\tsearch: z.string().optional(),\n\tunitId: uuidSchema.optional(),\n\trequestedBy: uuidSchema.optional(),\n\tassignedTo: uuidSchema.optional(),\n\tstatus: maintenanceStatusSchema.optional(),\n\tpriority: maintenancePrioritySchema.optional(),\n\tcategory: z.string().optional(), // Database shows this as string, not enum\n\tdateFrom: z\n\t\t.string()\n\t\t.optional()\n\t\t.refine((val: string | undefined) => !val || !isNaN(Date.parse(val)), {\n\t\t\tmessage: 'Invalid date format'\n\t\t}),\n\tdateTo: z\n\t\t.string()\n\t\t.optional()\n\t\t.refine((val: string | undefined) => !val || !isNaN(Date.parse(val)), {\n\t\t\tmessage: 'Invalid date format'\n\t\t}),\n\tminCost: nonNegativeNumberSchema.optional(),\n\tmaxCost: nonNegativeNumberSchema.optional(),\n\tsortBy: z\n\t\t.enum([\n\t\t\t'title',\n\t\t\t'priority',\n\t\t\t'status',\n\t\t\t'createdAt',\n\t\t\t'preferredDate',\n\t\t\t'estimatedCost'\n\t\t])\n\t\t.optional(),\n\tsortOrder: z.enum(['asc', 'desc']).optional().default('desc'),\n\tpage: z.coerce.number().int().positive().default(1),\n\tlimit: z.coerce.number().int().positive().max(100).default(10)\n})\n\n// Maintenance statistics schema\nexport const maintenanceStatsSchema = z.object({\n\ttotal: z.number().nonnegative(),\n\topen: z.number().nonnegative(),\n\tinProgress: z.number().nonnegative(),\n\tcompleted: z.number().nonnegative(),\n\tcanceled: z.number().nonnegative(),\n\tonHold: z.number().nonnegative(),\n\toverdue: z.number().nonnegative(),\n\taverageCompletionTime: z.number().nonnegative(), // in days\n\ttotalCost: z.number().nonnegative(),\n\taverageCost: z.number().nonnegative()\n})\n\n// Export types\nexport type MaintenanceRequestInput = z.infer<\n\ttypeof maintenanceRequestInputSchema\n>\nexport type MaintenanceRequest = z.infer<typeof maintenanceRequestSchema>\nexport type MaintenanceRequestUpdate = z.infer<\n\ttypeof maintenanceRequestUpdateSchema\n>\nexport type MaintenanceRequestQuery = z.infer<\n\ttypeof maintenanceRequestQuerySchema\n>\nexport type MaintenanceStats = z.infer<typeof maintenanceStatsSchema>\nexport type MaintenancePriorityValidation = z.infer<\n\ttypeof maintenancePrioritySchema\n>\nexport type MaintenanceStatusValidation = z.infer<\n\ttypeof maintenanceStatusSchema\n>\nexport type MaintenanceCategoryValidation = z.infer<\n\ttypeof maintenanceCategorySchema\n>\n\n// Frontend-specific form schema (handles string inputs from HTML forms)\nexport const maintenanceRequestFormSchema = z\n\t.object({\n\t\ttitle: requiredString,\n\t\tdescription: requiredString,\n\t\tpriority: z.string().default('MEDIUM'),\n\t\tcategory: z.string().optional().or(z.literal('')),\n\t\tunitId: requiredString,\n\t\trequestedBy: z.string().optional().or(z.literal('')),\n\t\tassignedTo: z.string().optional().or(z.literal('')),\n\t\tcontactPhone: z.string().optional(),\n\t\tallowEntry: z.boolean().optional().default(false),\n\t\testimatedCost: z\n\t\t\t.string()\n\t\t\t.optional()\n\t\t\t.transform((val: string | undefined) =>\n\t\t\t\tval ? parseFloat(val) : undefined\n\t\t\t),\n\t\tphotos: z.array(z.string()).optional().default([]),\n\t\tpreferredDate: z.string().optional().or(z.literal('')),\n\t\tnotes: z.string().optional()\n\t})\n\t.transform(\n\t\t(data: {\n\t\t\ttitle: string\n\t\t\tdescription: string\n\t\t\tpriority: string\n\t\t\tcategory?: string | undefined\n\t\t\tunitId: string\n\t\t\trequestedBy?: string | undefined\n\t\t\tassignedTo?: string | undefined\n\t\t\tcontactPhone?: string | undefined\n\t\t\tallowEntry: boolean\n\t\t\testimatedCost?: number | undefined\n\t\t\tphotos: string[]\n\t\t\tpreferredDate?: string | undefined\n\t\t\tnotes?: string | undefined\n\t\t}) => ({\n\t\t\t...data,\n\t\t\tpriority: data.priority as MaintenancePriorityValidation,\n\t\t\tcategory: data.category === '' ? undefined : data.category,\n\t\t\trequestedBy: data.requestedBy === '' ? undefined : data.requestedBy,\n\t\t\tassignedTo: data.assignedTo === '' ? undefined : data.assignedTo,\n\t\t\tpreferredDate: data.preferredDate === '' ? undefined : data.preferredDate,\n\t\t\tphotos: data.photos || []\n\t\t})\n\t)\n\nexport type MaintenanceRequestFormData = z.input<\n\ttypeof maintenanceRequestFormSchema\n>\nexport type MaintenanceRequestFormOutput = z.output<\n\ttypeof maintenanceRequestFormSchema\n>\n\n// Frontend-specific form schema for updates (handles string inputs from HTML forms)\nexport const maintenanceRequestUpdateFormSchema = z\n\t.object({\n\t\ttitle: z.string().optional(),\n\t\tdescription: z.string().optional(),\n\t\tpriority: z.string().optional(),\n\t\tcategory: z.string().optional().or(z.literal('')),\n\t\testimatedCost: z\n\t\t\t.string()\n\t\t\t.optional()\n\t\t\t.transform((val: string | undefined) =>\n\t\t\t\tval ? parseFloat(val) : undefined\n\t\t\t),\n\t\tnotes: z.string().optional(),\n\t\tpreferredDate: z.string().optional().or(z.literal('')),\n\t\tallowEntry: z.boolean().optional().default(false),\n\t\tstatus: z.string().optional(),\n\t\tactualCost: z\n\t\t\t.string()\n\t\t\t.optional()\n\t\t\t.transform((val: string | undefined) =>\n\t\t\t\tval ? parseFloat(val) : undefined\n\t\t\t),\n\t\tcompletedAt: z.string().optional().or(z.literal(''))\n\t})\n\t.transform(\n\t\t(data: {\n\t\t\ttitle?: string | undefined\n\t\t\tdescription?: string | undefined\n\t\t\tpriority?: string | undefined\n\t\t\tcategory?: string | undefined\n\t\t\testimatedCost?: number | undefined\n\t\t\tnotes?: string | undefined\n\t\t\tpreferredDate?: string | undefined\n\t\t\tallowEntry: boolean\n\t\t\tstatus?: string | undefined\n\t\t\tactualCost?: number | undefined\n\t\t\tcompletedAt?: string | undefined\n\t\t}) => ({\n\t\t\t...data,\n\t\t\tpriority: data.priority as MaintenancePriorityValidation | undefined,\n\t\t\tcategory: data.category === '' ? undefined : data.category,\n\t\t\tpreferredDate: data.preferredDate === '' ? undefined : data.preferredDate,\n\t\t\tcompletedAt: data.completedAt === '' ? undefined : data.completedAt,\n\t\t\tstatus: data.status as MaintenanceStatusValidation | undefined\n\t\t})\n\t)\n\nexport type MaintenanceRequestUpdateFormData = z.input<\n\ttypeof maintenanceRequestUpdateFormSchema\n>\nexport type MaintenanceRequestUpdateFormOutput = z.output<\n\ttypeof maintenanceRequestUpdateFormSchema\n>\n\n// Backward compatibility aliases\nexport const maintenanceInputSchema = maintenanceRequestInputSchema\nexport const maintenanceUpdateSchema = maintenanceRequestUpdateSchema\nexport const maintenanceCommentSchema = z.object({\n\tcontent: z\n\t\t.string()\n\t\t.min(1, 'Comment is required')\n\t\t.max(1000, 'Comment too long'),\n\tmaintenanceRequestId: uuidSchema\n})\nexport type MaintenanceRequestData = MaintenanceRequest\n\n// Backend DTO schemas - match CreateMaintenanceRequest/UpdateMaintenanceRequest from backend-domain.ts\nexport const createMaintenanceRequestSchema = z.object({\n\tunitId: uuidSchema,\n\ttitle: nonEmptyStringSchema\n\t\t.min(5, 'Title must be at least 5 characters')\n\t\t.max(200, 'Title cannot exceed 200 characters'),\n\tdescription: nonEmptyStringSchema\n\t\t.min(10, 'Description must be at least 10 characters')\n\t\t.max(2000, 'Description cannot exceed 2000 characters'),\n\tpriority: maintenancePrioritySchema.optional(),\n\tcategory: z.string().optional(),\n\tscheduledDate: z.string().optional(),\n\testimatedCost: nonNegativeNumberSchema.optional(),\n\tphotos: z.array(z.string()).optional(),\n\tallowEntry: z.boolean().optional(),\n\tcontactPhone: z.string().optional(),\n\tnotes: z.string().max(1000).optional().nullable()\n})\n\nexport const updateMaintenanceRequestSchema = z.object({\n\ttitle: z.string().optional(),\n\tdescription: z.string().optional(),\n\tpriority: z.string().optional(),\n\tcategory: z.string().optional(),\n\tstatus: z.string().optional(),\n\tscheduledDate: z.string().optional(),\n\tcompletedDate: z.string().optional(),\n\testimatedCost: z.number().optional(),\n\tactualCost: z.number().optional(),\n\tnotes: z.string().optional(),\n\tallowEntry: z.boolean().optional(),\n\tcontactPhone: z.string().optional()\n})\n\n// Backend DTO compatibility aliases\nexport type CreateMaintenanceRequestInput = MaintenanceRequestInput\nexport type UpdateMaintenanceRequestInput = MaintenanceRequestUpdate\nexport type MaintenanceQueryInput = MaintenanceRequestQuery\n"]}