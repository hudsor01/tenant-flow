{"version":3,"file":"lease-analytics.js","sourceRoot":"","sources":["lease-analytics.ts"],"names":[],"mappings":"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","sourcesContent":["import type {\n\tLeaseFinancialInsight,\n\tLeaseFinancialSummary\n} from '../types/financial-analytics.js'\nimport type {\n\tLeaseAnalyticsPageResponse,\n\tLeaseLifecyclePoint,\n\tLeaseStatusBreakdown\n} from '../types/lease-analytics.js'\n\nfunction toNumber(value: unknown, fallback = 0): number {\n\tif (typeof value === 'number' && Number.isFinite(value)) {\n\t\treturn value\n\t}\n\n\tif (typeof value === 'string') {\n\t\tconst parsed = Number(value)\n\t\tif (Number.isFinite(parsed)) {\n\t\t\treturn parsed\n\t\t}\n\t}\n\n\treturn fallback\n}\n\nfunction toString(value: unknown, fallback = ''): string {\n\tif (typeof value === 'string') {\n\t\treturn value\n\t}\n\tif (typeof value === 'number') {\n\t\treturn value.toString()\n\t}\n\treturn fallback\n}\n\nfunction isObject(value: unknown): value is Record<string, unknown> {\n\treturn typeof value === 'object' && value !== null\n}\n\nexport function mapLeaseSummary(data: unknown): LeaseFinancialSummary {\n\tif (!isObject(data)) {\n\t\treturn {\n\t\t\ttotalLeases: 0,\n\t\t\tactiveLeases: 0,\n\t\t\texpiringSoon: 0,\n\t\t\ttotalMonthlyRent: 0,\n\t\t\taverageLeaseValue: 0\n\t\t}\n\t}\n\n\treturn {\n\t\ttotalLeases: toNumber(data.total_leases ?? data.totalLeases),\n\t\tactiveLeases: toNumber(data.active_leases ?? data.activeLeases),\n\t\texpiringSoon: toNumber(data.expiring_soon ?? data.expiringSoon),\n\t\ttotalMonthlyRent: toNumber(\n\t\t\tdata.total_monthly_rent ?? data.totalMonthlyRent\n\t\t),\n\t\taverageLeaseValue: toNumber(\n\t\t\tdata.average_lease_value ?? data.averageLeaseValue\n\t\t)\n\t}\n}\n\nexport function mapLeaseProfitability(data: unknown): LeaseFinancialInsight[] {\n\tif (!Array.isArray(data)) {\n\t\treturn []\n\t}\n\n\treturn data.map(item => {\n\t\tconst record = isObject(item) ? item : {}\n\t\treturn {\n\t\t\tleaseId: toString(\n\t\t\t\trecord.lease_id ?? record.leaseId ?? toString(record.id ?? 'lease')\n\t\t\t),\n\t\t\tpropertyName: toString(\n\t\t\t\trecord.property_name ?? record.propertyName ?? 'Unknown Property'\n\t\t\t),\n\t\t\ttenantName: toString(\n\t\t\t\trecord.tenant_name ?? record.tenantName ?? 'Unknown Tenant'\n\t\t\t),\n\t\t\tmonthlyRent: toNumber(\n\t\t\t\trecord.monthly_rent ?? record.rent ?? record.amount\n\t\t\t),\n\t\t\toutstandingBalance: toNumber(\n\t\t\t\trecord.outstanding_balance ?? record.balance\n\t\t\t),\n\t\t\tprofitabilityScore:\n\t\t\t\trecord.profitability_score === null\n\t\t\t\t\t? null\n\t\t\t\t\t: toNumber(record.profitability_score ?? record.score)\n\t\t}\n\t})\n}\n\nexport function mapLeaseLifecycle(data: unknown): LeaseLifecyclePoint[] {\n\tif (!Array.isArray(data)) {\n\t\treturn []\n\t}\n\n\treturn data.map(item => {\n\t\tconst record = isObject(item) ? item : {}\n\t\treturn {\n\t\t\tperiod: toString(record.period ?? record.month ?? record.date ?? ''),\n\t\t\trenewals: toNumber(record.renewals ?? record.renewed),\n\t\t\texpirations: toNumber(record.expirations ?? record.expired),\n\t\t\tnoticesGiven: toNumber(record.notices ?? record.notices_given)\n\t\t}\n\t})\n}\n\nexport function mapLeaseStatusBreakdown(data: unknown): LeaseStatusBreakdown[] {\n\tif (!Array.isArray(data)) {\n\t\treturn []\n\t}\n\n\treturn data.map(item => {\n\t\tconst record = isObject(item) ? item : {}\n\t\treturn {\n\t\t\tstatus: toString(record.status ?? record.label ?? 'unknown'),\n\t\t\tcount: toNumber(record.count ?? record.total),\n\t\t\tpercentage: toNumber(record.percentage ?? record.percent)\n\t\t}\n\t})\n}\n\nexport function buildLeaseAnalyticsPageResponse(raw: {\n\tsummary?: unknown\n\tprofitability?: unknown\n\tlifecycle?: unknown\n\tstatusBreakdown?: unknown\n}): LeaseAnalyticsPageResponse {\n\treturn {\n\t\tmetrics: mapLeaseSummary(raw.summary),\n\t\tprofitability: mapLeaseProfitability(raw.profitability),\n\t\tlifecycle: mapLeaseLifecycle(raw.lifecycle),\n\t\tstatusBreakdown: mapLeaseStatusBreakdown(raw.statusBreakdown)\n\t}\n}\n"]}