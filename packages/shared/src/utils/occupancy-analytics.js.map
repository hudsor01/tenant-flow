{"version":3,"file":"occupancy-analytics.js","sourceRoot":"","sources":["occupancy-analytics.ts"],"names":[],"mappings":"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","sourcesContent":["import type {\n\tOccupancyAnalyticsPageResponse,\n\tOccupancyMetricSummary,\n\tOccupancyTrendPoint,\n\tVacancyAnalysisEntry\n} from '../types/occupancy-analytics.js'\n\nfunction toNumber(value: unknown, fallback = 0): number {\n\tif (typeof value === 'number' && Number.isFinite(value)) {\n\t\treturn value\n\t}\n\tif (typeof value === 'string') {\n\t\tconst parsed = Number(value)\n\t\tif (Number.isFinite(parsed)) {\n\t\t\treturn parsed\n\t\t}\n\t}\n\treturn fallback\n}\n\nfunction toString(value: unknown, fallback = ''): string {\n\tif (typeof value === 'string') {\n\t\treturn value\n\t}\n\tif (typeof value === 'number') {\n\t\treturn value.toString()\n\t}\n\treturn fallback\n}\n\nfunction isObject(value: unknown): value is Record<string, unknown> {\n\treturn typeof value === 'object' && value !== null\n}\n\nexport function mapOccupancyMetrics(data: unknown): OccupancyMetricSummary {\n\tif (!isObject(data)) {\n\t\treturn {\n\t\t\tcurrentOccupancy: 0,\n\t\t\taverageVacancyDays: 0,\n\t\t\tseasonalPeakOccupancy: 0,\n\t\t\ttrend: 0\n\t\t}\n\t}\n\n\treturn {\n\t\tcurrentOccupancy: toNumber(\n\t\t\tdata.current_occupancy ?? data.currentOccupancy ?? data.occupancy_rate\n\t\t),\n\t\taverageVacancyDays: toNumber(\n\t\t\tdata.average_vacancy_days ?? data.avgVacancyDays\n\t\t),\n\t\tseasonalPeakOccupancy: toNumber(\n\t\t\tdata.seasonal_peak_occupancy ?? data.seasonalPeak ?? data.peak_occupancy\n\t\t),\n\t\ttrend: toNumber(data.trend ?? data.delta ?? 0)\n\t}\n}\n\nexport function mapOccupancyTrends(data: unknown): OccupancyTrendPoint[] {\n\tif (!Array.isArray(data)) {\n\t\treturn []\n\t}\n\n\treturn data.map(item => {\n\t\tconst record = isObject(item) ? item : {}\n\t\treturn {\n\t\t\tperiod: toString(record.period ?? record.month ?? record.date ?? ''),\n\t\t\toccupancyRate: toNumber(\n\t\t\t\trecord.occupancy_rate ?? record.occupancyRate ?? record.rate\n\t\t\t),\n\t\t\toccupiedUnits: toNumber(\n\t\t\t\trecord.occupied_units ?? record.occupiedUnits ?? record.occupied\n\t\t\t),\n\t\t\ttotalUnits: toNumber(\n\t\t\t\trecord.total_units ?? record.totalUnits ?? record.total\n\t\t\t)\n\t\t}\n\t})\n}\n\nexport function mapVacancyAnalysis(data: unknown): VacancyAnalysisEntry[] {\n\tif (!Array.isArray(data)) {\n\t\treturn []\n\t}\n\n\treturn data.map(item => {\n\t\tconst record = isObject(item) ? item : {}\n\t\treturn {\n\t\t\tpropertyId: toString(record.property_id ?? record.propertyId ?? ''),\n\t\t\tpropertyName: toString(\n\t\t\t\trecord.property_name ?? record.propertyName ?? 'Property'\n\t\t\t),\n\t\t\tvacancyDays: toNumber(\n\t\t\t\trecord.vacancy_days ?? record.avgVacancyDays ?? record.days\n\t\t\t),\n\t\t\tturnovers: toNumber(\n\t\t\t\trecord.turnovers ?? record.move_outs ?? record.turnover_count\n\t\t\t),\n\t\t\tnotes: toString(record.notes ?? record.remark ?? '')\n\t\t}\n\t})\n}\n\nexport function buildOccupancyAnalyticsPageResponse(raw: {\n\tmetrics?: unknown\n\ttrends?: unknown\n\tvacancy?: unknown\n}): OccupancyAnalyticsPageResponse {\n\treturn {\n\t\tmetrics: mapOccupancyMetrics(raw.metrics),\n\t\ttrends: mapOccupancyTrends(raw.trends),\n\t\tvacancyAnalysis: mapVacancyAnalysis(raw.vacancy)\n\t}\n}\n"]}