{"version":3,"file":"maintenance-analytics.js","sourceRoot":"","sources":["maintenance-analytics.ts"],"names":[],"mappings":"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","sourcesContent":["import type {\n\tMaintenanceAnalyticsPageResponse,\n\tMaintenanceCategoryBreakdown,\n\tMaintenanceCostBreakdownEntry,\n\tMaintenanceMetricSummary,\n\tMaintenanceTrendPoint\n} from '../types/maintenance-analytics.js'\n\nfunction toNumber(value: unknown, fallback = 0): number {\n\tif (typeof value === 'number' && Number.isFinite(value)) {\n\t\treturn value\n\t}\n\tif (typeof value === 'string') {\n\t\tconst parsed = Number(value)\n\t\tif (Number.isFinite(parsed)) {\n\t\t\treturn parsed\n\t\t}\n\t}\n\treturn fallback\n}\n\nfunction toString(value: unknown, fallback = ''): string {\n\tif (typeof value === 'string') {\n\t\treturn value\n\t}\n\tif (typeof value === 'number') {\n\t\treturn value.toString()\n\t}\n\treturn fallback\n}\n\nfunction isObject(value: unknown): value is Record<string, unknown> {\n\treturn typeof value === 'object' && value !== null\n}\n\nexport function mapMaintenanceMetrics(data: unknown): MaintenanceMetricSummary {\n\tif (!isObject(data)) {\n\t\treturn {\n\t\t\topenRequests: 0,\n\t\t\tinProgressRequests: 0,\n\t\t\tcompletedRequests: 0,\n\t\t\taverageResponseTimeHours: 0,\n\t\t\ttotalCost: 0\n\t\t}\n\t}\n\n\treturn {\n\t\topenRequests: toNumber(\n\t\t\tdata.open_requests ?? data.openRequests ?? data.open\n\t\t),\n\t\tinProgressRequests: toNumber(\n\t\t\tdata.in_progress_requests ?? data.inProgressRequests ?? data.inProgress\n\t\t),\n\t\tcompletedRequests: toNumber(\n\t\t\tdata.completed_requests ?? data.completedRequests ?? data.completed\n\t\t),\n\t\taverageResponseTimeHours: toNumber(\n\t\t\tdata.average_response_time_hours ??\n\t\t\t\tdata.averageResponseTimeHours ??\n\t\t\t\tdata.avg_response_time ??\n\t\t\t\t0\n\t\t),\n\t\ttotalCost: toNumber(data.total_cost ?? data.totalCost)\n\t}\n}\n\nexport function mapMaintenanceCostBreakdown(\n\tdata: unknown\n): MaintenanceCostBreakdownEntry[] {\n\tif (!Array.isArray(data)) {\n\t\treturn []\n\t}\n\n\treturn data.map(item => {\n\t\tconst record = isObject(item) ? item : {}\n\t\treturn {\n\t\t\tcategory: toString(record.category ?? record.label ?? 'Other'),\n\t\t\tamount: toNumber(record.amount ?? record.value),\n\t\t\tpercentage: toNumber(record.percentage ?? record.percent)\n\t\t}\n\t})\n}\n\nexport function mapMaintenanceTrends(data: unknown): MaintenanceTrendPoint[] {\n\tif (!Array.isArray(data)) {\n\t\treturn []\n\t}\n\n\treturn data.map(item => {\n\t\tconst record = isObject(item) ? item : {}\n\t\treturn {\n\t\t\tperiod: toString(record.period ?? record.month ?? record.date ?? ''),\n\t\t\tcompleted: toNumber(record.completed ?? record.done),\n\t\t\tpending: toNumber(record.pending ?? record.open),\n\t\t\tavgResolutionTime: toNumber(\n\t\t\t\trecord.avg_resolution_time ?? record.averageResolutionTime ?? 0\n\t\t\t)\n\t\t}\n\t})\n}\n\nexport function mapMaintenanceCategoryBreakdown(\n\tdata: unknown\n): MaintenanceCategoryBreakdown[] {\n\tif (!Array.isArray(data)) {\n\t\treturn []\n\t}\n\n\treturn data.map(item => {\n\t\tconst record = isObject(item) ? item : {}\n\t\treturn {\n\t\t\tcategory: toString(record.category ?? record.label ?? 'Other'),\n\t\t\tcount: toNumber(record.count ?? record.total)\n\t\t}\n\t})\n}\n\nexport function buildMaintenanceAnalyticsPageResponse(raw: {\n\tmetrics?: unknown\n\tcostBreakdown?: unknown\n\ttrends?: unknown\n\tcategoryBreakdown?: unknown\n}): MaintenanceAnalyticsPageResponse {\n\treturn {\n\t\tmetrics: mapMaintenanceMetrics(raw.metrics),\n\t\tcostBreakdown: mapMaintenanceCostBreakdown(raw.costBreakdown),\n\t\ttrends: mapMaintenanceTrends(raw.trends),\n\t\tcategoryBreakdown: mapMaintenanceCategoryBreakdown(raw.categoryBreakdown)\n\t}\n}\n"]}