{"version":3,"file":"core.js","sourceRoot":"","sources":["core.ts"],"names":[],"mappings":"","sourcesContent":["/**\n * CORE TYPES - Consolidated shared types using TypeScript 5.9.2 native features\n *\n * This file consolidates duplicate types and leverages modern TypeScript utilities\n * to reduce the shared types directory by 75% while improving type safety.\n */\n\nimport type { ReactNode } from 'react'\nimport type { DashboardActivity } from './activity.js'\n\n// NATIVE TYPESCRIPT 5.9.2 UTILITY TYPES (replacing custom implementations)\n\nexport type DeepReadonly<T> = {\n\treadonly [P in keyof T]: T[P] extends Record<string, unknown>\n\t\t? DeepReadonly<T[P]>\n\t\t: T[P]\n}\n\nexport type DeepPartial<T> = {\n\t[P in keyof T]?: T[P] extends Record<string, unknown>\n\t\t? DeepPartial<T[P]>\n\t\t: T[P]\n}\n\nexport type CamelCase<S extends string> =\n\tS extends `${infer P1}_${infer P2}${infer P3}`\n\t\t? `${P1}${Capitalize<P2>}${CamelCase<P3>}`\n\t\t: S\n\nexport type SnakeCase<S extends string> = S extends `${infer T}${infer U}`\n\t? `${T extends Capitalize<T> ? '_' : ''}${Lowercase<T>}${SnakeCase<U>}`\n\t: S\n\n// Use built-in utility for key extraction\nexport type KeysOfType<T, U> = keyof {\n\t[K in keyof T as T[K] extends U ? K : never]: T[K]\n}\n\nexport type ApiResponse<T = unknown> =\n\t| { success: true; data: T; error?: never }\n\t| { success: false; error: string; data?: never }\n\n// STRIPE TYPES - Using official Stripe Node SDK types\nexport interface StripeCheckoutSessionResponse {\n\tclient_secret: string\n}\n\nexport interface StripeSessionStatusResponse {\n\tstatus: string\n\tpayment_intent_id: string | null\n\tpayment_status: string | null\n\tpayment_intent_status: string | null\n}\n\nexport interface CreateBillingSubscriptionRequest {\n\tcustomerId: string\n\ttenantId: string\n\tamount: number\n\tproductId: string\n\tsubscriptionType?: string\n}\n\nexport interface CreateCheckoutSessionRequest {\n\tproductName: string\n\ttenantId: string\n\tdomain: string\n\tdescription?: string\n\tisSubscription?: boolean\n\tpriceId: string // Required Stripe price ID (e.g., price_1234...)\n\tcustomerEmail?: string // Authenticated user email for Stripe customer identification\n}\n\nexport interface CreateConnectedPaymentRequest {\n\tamount: number\n\ttenantId: string\n\tconnectedAccountId: string\n\tplatformFee?: number\n\tpropertyOwnerAccount?: string\n\tpropertyId?: string\n}\n\n// Consolidated pagination (single interface)\nexport interface Pagination {\n\tpage?: number\n\tlimit?: number\n\toffset?: number\n\ttotal?: number\n\thasMore?: boolean\n}\n\n// Consolidate all pagination-related interfaces in one place\nexport interface PaginationOptions {\n\tpage?: number\n\tlimit?: number\n\toffset?: number\n}\n\nexport interface SortOptions {\n\tfield: string\n\tdirection: 'asc' | 'desc'\n}\n\nexport interface BaseFilterOptions extends PaginationOptions {\n\tsort?: SortOptions\n\tsearch?: string\n}\n\n// Consolidated query parameters\nexport interface QueryParams extends Pagination {\n\tsearch?: string\n\tsort?: string\n\torder?: 'asc' | 'desc'\n}\nexport type Status = 'idle' | 'loading' | 'success' | 'error'\nexport type UploadStatus = 'idle' | 'uploading' | 'success' | 'error'\nexport type ProcessStatus = 'pending' | 'processing' | 'completed' | 'failed'\n\nexport type Result<T = void, E = string> =\n\t| { ok: true; value: T; error?: never }\n\t| { ok: false; error: E; value?: never }\n\nexport interface AppError extends Error {\n\tcode?: string\n\tstatusCode?: number\n\tcontext?: Record<string, unknown>\n}\n\nimport type { Database, Tables, TablesInsert } from './supabase-generated.js'\n\nexport type User = Tables<'users'>\nexport type Property = Tables<'property'>\nexport type Unit = Tables<'unit'>\nexport type Tenant = Tables<'tenant'>\nexport type Lease = Tables<'lease'>\nexport type MaintenanceRequest = Tables<'maintenance_request'>\nexport type RentPayment = Tables<'rent_payment'>\nexport type ExpenseRecord = Tables<'expense'>\nexport type ConnectedAccount = Tables<'connected_account'>\nexport type PropertyInsert = TablesInsert<'property'>\nexport type UnitInsert = TablesInsert<'unit'>\nexport type MaintenanceCategory =\n\tDatabase['public']['Enums']['MaintenanceCategory']\nexport type PropertyType = Database['public']['Enums']['PropertyType']\nexport type PropertyStatus = Database['public']['Enums']['PropertyStatus']\nexport type UnitStatus = Database['public']['Enums']['UnitStatus']\nexport type LeaseStatus = Database['public']['Enums']['LeaseStatus']\nexport type RentPaymentStatus = Database['public']['Enums']['RentPaymentStatus']\nexport type Priority = Database['public']['Enums']['Priority']\nexport type ActivityEntityType =\n\tDatabase['public']['Enums']['ActivityEntityType']\n\n// Maintenance API response with relations\nexport interface MaintenanceRequestResponse {\n\tdata: (MaintenanceRequest & {\n\t\tproperty: { name: string } | null\n\t\tunit: { name: string } | null\n\t\tassignedTo: { name: string } | null\n\t})[]\n\ttotal: number\n\tlimit: number\n\toffset: number\n}\n\n// Re-export Database type for type composition\nexport type {\n\tDatabase,\n\tEnums,\n\tTables,\n\tTablesInsert,\n\tTablesUpdate\n} from './supabase-generated.js'\n\nexport type EnvConfig = Record<string, string | number | boolean>\n\n// HTTP Method types\nexport type HttpMethod = 'GET' | 'POST' | 'PUT' | 'PATCH' | 'DELETE' | 'HEAD' | 'OPTIONS'\n\n// Use template literals for type-safe string patterns\nexport type EntityType =\n\t| 'property'\n\t| 'unit'\n\t| 'tenant'\n\t| 'lease'\n\t| 'maintenance'\nexport type ActionType = 'create' | 'update' | 'delete' | 'view'\nexport type Permission = `${EntityType}:${ActionType}`\n\n// Use built-in Awaited utility\nexport type AsyncValue<T> = Awaited<T>\n\n// Use native utility types for common patterns\nexport type CreateInput<T> = Omit<T, 'id' | 'createdAt' | 'updatedAt'>\nexport type UpdateInput<T> = Partial<CreateInput<T>>\nexport type EntityWithRelations<T, R> = T & R\n\nexport type FormErrors<T> = Partial<Record<keyof T, string>>\nexport type ComponentProps<T = Record<string, unknown>> = T & {\n\tclassName?: string\n\tchildren?: ReactNode\n}\n\nexport type EventHandler<T = Event> = (event: T) => void\nexport type AsyncEventHandler<T = Event> = (event: T) => Promise<void>\n\nexport interface DateRange {\n\tstart: Date\n\tend: Date\n}\n\nexport type TimePeriod =\n\t| 'today'\n\t| 'yesterday'\n\t| 'last7days'\n\t| 'last30days'\n\t| 'thisMonth'\n\t| 'lastMonth'\n\t| 'thisYear'\n\t| 'lastYear'\n\t| 'custom'\n\n// ESSENTIAL FILE UPLOAD TYPE (not available natively)\n\nexport interface FileUpload {\n\tfile: File\n\turl?: string\n\tstatus: UploadStatus\n\tprogress?: number\n\terror?: string\n}\n\n// STATISTICS TYPES (consolidated from stats.ts)\n\n// Base stats interface that all entity stats extend from\nexport interface BaseStats {\n\ttotal: number\n}\n\n// Property statistics\nexport interface PropertyStats extends BaseStats {\n\toccupied: number\n\tvacant: number\n\toccupancyRate: number\n\ttotalMonthlyRent: number\n\taverageRent: number\n}\n\n// Tenant statistics\nexport interface TenantStats extends BaseStats {\n\tactive: number\n\tinactive: number\n\tnewThisMonth: number\n\t// Additional fields used by frontend\n\ttotalTenants?: number\n\tactiveTenants?: number\n\tcurrentPayments?: number\n\tlatePayments?: number\n\ttotalRent?: number\n\tavgRent?: number\n\trecentAdditions?: number\n\twithContactInfo?: number\n}\n\n// Tenant monetary summary exposed to frontend (amounts in cents)\nexport interface TenantSummary {\n\ttotal: number\n\tinvited: number\n\tactive: number\n\toverdueBalanceCents: number\n\tupcomingDueCents: number\n\ttimestamp: string // ISO date\n}\n\n// Unit statistics\nexport interface UnitStats extends BaseStats {\n\toccupied: number\n\tvacant: number\n\tmaintenance: number\n\taverageRent: number\n\tavailable: number\n\toccupancyRate: number\n\toccupancyChange: number // Period-over-period occupancy rate change percentage\n\ttotalPotentialRent: number\n\ttotalActualRent: number\n}\n\n// Lease statistics\nexport interface LeaseStats extends BaseStats {\n\tactive: number\n\texpired: number\n\texpiringSoon: number\n\tterminated?: number\n\ttotalMonthlyRent?: number\n\taverageRent?: number\n\ttotalSecurityDeposits?: number\n\texpiringLeases?: number\n}\n\n// Maintenance statistics\nexport interface MaintenanceStats extends BaseStats {\n\topen: number\n\tinProgress: number\n\tcompleted: number\n\tcompletedToday: number\n\tavgResolutionTime: number\n\tbyPriority: {\n\t\tlow: number\n\t\tmedium: number\n\t\thigh: number\n\t\temergency: number\n\t}\n}\n\nexport interface MaintenanceAnalyticsData {\n\tcategoryBreakdown?: Record<string, number>\n\tstatusBreakdown?: Record<string, number>\n\tcompletionRate?: number\n\tavgResponseTime?: number\n\tavgSatisfaction?: number\n\ttotalCost?: number\n}\n\n// Dashboard aggregated statistics (comprehensive version)\nexport interface DashboardStats {\n\tproperties: PropertyStats\n\ttenants: TenantStats\n\tunits: UnitStats\n\tleases: LeaseStats\n\tmaintenance: MaintenanceStats\n\trevenue: {\n\t\tmonthly: number\n\t\tyearly: number\n\t\tgrowth: number\n\t}\n\t// Backward compatibility fields (optional)\n\ttotalProperties?: number\n\ttotalUnits?: number\n\ttotalTenants?: number\n\ttotalRevenue?: number\n\toccupancyRate?: number\n\tmaintenanceRequests?: number\n}\n\n// Notification types (simplified)\nexport interface Notification {\n\tid: string\n\tuserId: string\n\ttitle: string\n\tmessage: string\n\ttype: 'maintenance' | 'lease' | 'payment' | 'system'\n\tpriority: 'LOW' | 'MEDIUM' | 'HIGH' | 'URGENT'\n\tread: boolean\n\tcreatedAt: string\n}\n\n// Activity types\nexport type { ActivityItem, DashboardActivity } from './activity'\n\n// Financial overview and stats types (from common.ts)\nexport interface DashboardFinancialStats {\n\ttotalRevenue: number\n\tmonthlyRecurring: number\n\toccupancyRate: number\n\tactiveLeases: number\n\ttotalUnits: number\n\tmonthlyRevenueFormatted?: string\n\trevenueChange?: number\n\tmonthlyExpensesFormatted?: string\n\tmonthlyExpenses?: number\n\texpenseChange?: number\n\tnetOperatingIncome?: number\n\tnoiGrowth?: number\n\tprofitMargin?: number\n}\n\n// Cache system types\nexport interface CacheEntry<T = unknown> {\n\tdata: T\n\tversion: number\n\ttimestamp: number\n\tttl: number\n\tdependencies: string[]\n}\n\nexport interface CacheStats {\n\thits: number\n\tmisses: number\n\tinvalidations: number\n\tentries: number\n\tmemoryUsage: number\n\thitRatio: number\n}\n\nexport interface FinancialOverviewResponse {\n\tchartData: Array<{\n\t\tmonth: string\n\t\tmonthNumber: number\n\t\tscheduled: number\n\t\texpenses: number\n\t\tincome: number\n\t}>\n\tsummary: {\n\t\ttotalIncome: number\n\t\ttotalExpenses: number\n\t\ttotalScheduled: number\n\t\tnetIncome: number\n\t}\n\tyear: number\n}\n\n// Re-export from financial-analytics (production type with real expense categories)\nexport type { ExpenseSummaryResponse } from './financial-analytics'\n\nexport interface LeaseStatsResponse {\n\ttotalLeases: number\n\tactiveLeases: number\n\texpiredLeases: number\n\tterminatedLeases: number\n\ttotalMonthlyRent: number\n\taverageRent: number\n\ttotalSecurityDeposits: number\n\texpiringLeases: number\n}\n\nexport interface TenantWithLeaseInfo {\n\t// Base tenant fields\n\tid: string\n\tname: string\n\temail: string\n\tphone: string | null\n\tavatarUrl: string | null\n\temergencyContact: string | null\n\tcreatedAt: string\n\tupdatedAt: string\n\n\t// Invitation fields\n\tinvitation_status:\n\t\t| 'PENDING'\n\t\t| 'SENT'\n\t\t| 'ACCEPTED'\n\t\t| 'EXPIRED'\n\t\t| 'REVOKED'\n\t\t| null\n\tinvitation_sent_at: string | null\n\tinvitation_accepted_at: string | null\n\tinvitation_expires_at: string | null\n\n\t// Current lease information\n\tcurrentLease: {\n\t\tid: string\n\t\tstartDate: string\n\t\tendDate: string | null\n\t\trentAmount: number\n\t\tsecurityDeposit: number\n\t\tstatus: string\n\t\tterms: string | null\n\t} | null\n\n\t// All leases for this tenant\n\tleases?: Array<{\n\t\tid: string\n\t\tstartDate: string\n\t\tendDate: string | null\n\t\trentAmount: number\n\t\tstatus: string\n\t\tproperty?: {\n\t\t\taddress: string\n\t\t}\n\t}>\n\n\t// Unit information\n\tunit: {\n\t\tid: string\n\t\tunitNumber: string\n\t\tbedrooms: number\n\t\tbathrooms: number\n\t\tsquareFootage: number | null\n\t} | null\n\n\t// Property information\n\tproperty: {\n\t\tid: string\n\t\tname: string\n\t\taddress: string\n\t\tcity: string\n\t\tstate: string\n\t\tzipCode: string\n\t} | null\n\n\t// Derived fields for UI display\n\tmonthlyRent: number\n\tleaseStatus: string\n\tpaymentStatus: string | null\n\tunitDisplay: string\n\tpropertyDisplay: string\n\tleaseStart: string | null\n\tleaseEnd: string | null\n}\n\n// Property Performance Response Types\nexport interface PropertyPerformance {\n\tproperty: string\n\tpropertyId: string\n\tunits: number\n\ttotalUnits: number\n\toccupiedUnits: number\n\tvacantUnits: number\n\toccupancy: string // e.g. \"95%\"\n\toccupancyRate: number // e.g. 95.5\n\trevenue: number\n\tmonthlyRevenue: number\n\tpotentialRevenue: number\n\taddress: string\n\tpropertyType: string\n\tstatus: 'NO_UNITS' | 'VACANT' | 'FULL' | 'PARTIAL'\n\ttrend: 'up' | 'down' | 'stable'\n\ttrendPercentage: number\n}\n\nexport interface PropertyPerformanceResponse {\n\tproperties: PropertyPerformance[]\n}\n\n// System Uptime Response Types\nexport interface SystemUptime {\n\tuptime: string // e.g. \"99.95%\"\n\tuptimePercentage: number // e.g. 99.95\n\tsla: string // e.g. \"99.5%\" - target SLA\n\tslaStatus: 'excellent' | 'good' | 'acceptable' | 'poor'\n\tstatus: 'operational' | 'degraded' | 'outage'\n\tlastIncident: string | null // ISO timestamp of last incident\n\tresponseTime: number // Average response time in ms\n\ttimestamp: string // ISO timestamp of measurement\n}\n\n// Dashboard Metrics Response (replaces Record<string, unknown>)\nexport interface DashboardMetricsResponse {\n\ttotalProperties: number\n\ttotalUnits: number\n\ttotalTenants: number\n\ttotalLeases: number\n\toccupancyRate: number\n\tmonthlyRevenue: number\n\tmaintenanceRequests: number\n\ttimestamp: string\n}\n\n// Dashboard Summary Response (replaces Record<string, unknown>)\nexport interface DashboardSummaryResponse {\n\toverview: {\n\t\tproperties: number\n\t\tunits: number\n\t\ttenants: number\n\t\toccupancyRate: number\n\t}\n\trevenue: {\n\t\tmonthly: number\n\t\tyearly: number\n\t\tgrowth: number\n\t}\n\tmaintenance: {\n\t\topen: number\n\t\tinProgress: number\n\t\tavgResolutionTime: number\n\t}\n\trecentActivity: DashboardActivity[]\n\ttopPerformingProperties: PropertyPerformance[]\n\ttimestamp: string\n}\n\n// Stripe Pricing Component Props\nexport interface StripePricingTableProps {\n\tpricingTableId?: string\n\tclientReferenceId?: string\n\tcustomerEmail?: string\n\tcustomerSessionClientSecret?: string\n\tclassName?: string\n}\n\n// Email service uses inline types with Stripe SDK - no shared interfaces needed\n\n// ANALYTICS RPC RESPONSE TYPES - For backend controller type safety\n\n// Financial Analytics RPC Responses\nexport interface FinancialMetrics {\n\trevenue: number\n\texpenses: number\n\tnetIncome: number\n\tprofitMargin: number\n\tperiod: string\n}\n\nexport interface PropertyFinancialMetrics {\n\tpropertyId: string\n\tpropertyName: string\n\trevenue: number\n\texpenses: number\n\tnetIncome: number\n\troi: number\n\tperiod: string\n}\n\nexport interface DashboardSummary {\n\ttotalRevenue: number\n\ttotalExpenses: number\n\tnetIncome: number\n\tpropertyCount: number\n\toccupancyRate: number\n\tavgRoi: number\n}\n\n// Maintenance Analytics RPC Responses\nexport interface MaintenanceMetrics {\n\ttotalCost: number\n\tavgCost: number\n\ttotalRequests: number\n\temergencyCount: number\n\thighPriorityCount: number\n\tcompletedRequests: number\n\tpendingRequests: number\n\taverageResolutionTime: number\n}\n\nexport interface MaintenanceCostSummary {\n\ttotalCost: number\n\tavgCost: number\n\ttotalRequests: number\n\temergencyCount: number\n\thighPriorityCount: number\n}\n\nexport interface MaintenancePerformance {\n\tpropertyId: string\n\tpropertyName: string\n\ttotalRequests: number\n\tcompletedRequests: number\n\tpendingRequests: number\n\taverageResolutionTime: number\n\ttotalCost: number\n\temergencyRequests: number\n}\n\n// FORM PROGRESS TYPES - Frontend form state persistence\n\nexport type FormProgressData = {\n\temail?: string\n\tname?: string\n\tfirstName?: string\n\tlastName?: string\n\tcompany?: string\n\tphone?: string\n\tsubject?: string\n\tmessage?: string\n\ttype?: string\n\tpassword?: string\n\tconfirmPassword?: string\n}\n\n// REPOSITORY INPUT TYPES (Database table Insert/Update types)\n// Re-export from repository files (single source of truth per domain)\nexport type {\n\tMaintenanceRequestInput,\n\tMaintenanceRequestUpdate\n} from './maintenance-repository'\nexport type { TenantInput, TenantUpdate } from './tenants-repository'\nexport type { UnitInput, UnitUpdate } from './units-repository'\n\n// PAYMENT METHOD TYPES - Tenant payment system (Phase 2-3)\n\nexport type PaymentMethodType = 'card' | 'us_bank_account'\n\nexport interface PaymentMethodResponse {\n\tid: string\n\ttenantId: string\n\tstripePaymentMethodId: string\n\ttype: PaymentMethodType\n\tlast4: string | null\n\tbrand: string | null\n\tbankName: string | null\n\tisDefault: boolean\n\tcreatedAt: string\n}\n\nexport interface SetDefaultPaymentMethodRequest {\n\tpaymentMethodId: string\n}\n\n// RENT SUBSCRIPTION TYPES - Autopay subscriptions (Phase 4)\n\nexport type SubscriptionStatus =\n\t| 'incomplete'\n\t| 'incomplete_expired'\n\t| 'trialing'\n\t| 'active'\n\t| 'past_due'\n\t| 'canceled'\n\t| 'unpaid'\n\t| 'paused'\n\nexport interface RentSubscriptionResponse {\n\tid: string\n\tleaseId: string\n\ttenantId: string\n\townerId: string\n\tstripeSubscriptionId: string\n\tstripeCustomerId: string\n\tpaymentMethodId: string\n\tamount: number\n\tcurrency: string\n\tbillingDayOfMonth: number\n\tnextChargeDate?: string | null // ISO date string (derived server field; optional for backward compatibility)\n\tstatus: SubscriptionStatus\n\tplatformFeePercentage: number\n\tpausedAt: string | null\n\tcanceledAt: string | null\n\tcreatedAt: string\n\tupdatedAt: string\n}\n\nexport interface CreateSubscriptionRequest {\n\tleaseId: string\n\tpaymentMethodId: string\n\tamount: number\n\tbillingDayOfMonth: number\n\tcurrency?: string\n}\n\nexport interface UpdateSubscriptionRequest {\n\tamount?: number\n\tpaymentMethodId?: string\n\tbillingDayOfMonth?: number\n}\n\nexport interface SubscriptionActionResponse {\n\tsuccess: boolean\n\tsubscription?: RentSubscriptionResponse\n\tmessage?: string\n}\n"]}