{"version":3,"file":"file-upload.js","sourceRoot":"","sources":["file-upload.ts"],"names":[],"mappings":"","sourcesContent":["/**\n * File upload related types shared between frontend and backend\n * Enhanced with comprehensive security validation and audit capabilities\n */\n\n/**\n * Result of a successful file upload with security context\n */\nexport interface FileUploadResult {\n\turl: string\n\tpath: string\n\tfilename: string\n\tsize: number\n\tmimeType: string\n\tbucket: string\n\thash?: string\n\tuploadedAt: Date\n\tuploadedBy?: string\n\tsecurityScanStatus?: 'pending' | 'clean' | 'quarantined' | 'malicious'\n}\n\n/**\n * Enhanced options for secure file upload operations\n */\nexport interface FileUploadOptions {\n\tmaxSize?: number\n\tallowedMimeTypes?: string[]\n\tallowedExtensions?: string[]\n\tgenerateUniqueName?: boolean\n\tpreserveOriginalName?: boolean\n\tpath?: string\n\tscanForMalware?: boolean\n\tvalidateContent?: boolean\n\tquarantineOnSuspicion?: boolean\n\tuserId?: string\n\tcontext?: FileUploadContext\n\t// Supabase Storage specific options\n\tcontentType?: string\n\tcacheControl?: string\n\tupsert?: boolean\n}\n\n/**\n * File upload context for security categorization\n */\nexport type FileUploadContext =\n\t| 'documents'\n\t| 'images'\n\t| 'avatar'\n\t| 'maintenance'\n\t| 'contracts'\n\t| 'reports'\n\n/**\n * Enhanced file validation configuration\n */\nexport interface FileValidationConfig {\n\tmaxFileSize: number\n\tallowedMimeTypes: string[]\n\tallowedExtensions: string[]\n\tallowedMagicNumbers: Record<string, number[][]>\n\tscanForMalware: boolean\n\tvalidateContent: boolean\n\tquarantineOnSuspicion: boolean\n}\n\n/**\n * Enhanced file validation result with security context\n */\nexport interface FileValidationResult {\n\tisValid: boolean\n\terrors?: string[]\n\twarnings?: string[]\n\tfileInfo?: {\n\t\tname: string\n\t\tsize: number\n\t\tmimeType: string\n\t\textension: string\n\t\tmagicNumber?: string\n\t\thash?: string\n\t}\n\tsecurityFlags?: {\n\t\tcontainsScript: boolean\n\t\tcontainsMacros: boolean\n\t\tpotentialMalware: boolean\n\t\tsuspiciousName: boolean\n\t\toversized: boolean\n\t}\n}\n"]}